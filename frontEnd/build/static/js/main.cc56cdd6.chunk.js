(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{103:function(e,t,n){e.exports=n(260)},252:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAQAAABKfvVzAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfaBBoAAAC1VYTSAAABiklEQVQ4y73Sv04UURTH8e+5M7C7ZndAdgETTbTTxpgIRgoLY2Ik2PoG64PwDEQLEgs6NbYWPoAVCTZWNIRAQpAF/0Ci7u7M+VnMYBbYgUrPKU5ycz+559574F+H5WVmYGntXBDlpU+deNRC6s4VvlwMbmJ1X/Rn9p0d9ymm2DsfTKNJLemhFnSVrYNOlRaT7JeDFt7ytjdU1309rl1iMz0STZoclAE11FYihJp6pAfWs82sKyaY4NtZcBlPvO2J4zgedE1P/I59Ddtp5ozz4zQYR4meFyfkOaJbeuo3bKey26PBGIeDIDkLEKppRvP9MTb8sFo0FnKQlmZ23Rf9rc39LloqQFaSTkqKz/ptL0CcF2d4CLB1luwNJ0FaNgm79tqWK+vp8dAdg2zY5iN7zwutjqR9ROcC0OOjveRD9DMiOzEiw1qSfbZle2cd4xfVgU87fUIAsG1WbGV0wwGnS3f43QJhOqyF/ehVfM+sQo1qySvY3xLpLjGf4q4B/bJXGwBFFVb6K/8n/gBIW70kwgYH3gAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNi0wOS0xN1QxNToxODoyNSswODowMCtEZsAAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTAtMDQtMjZUMDA6MDA6MDArMDg6MDCgVTtdAAAATXRFWHRzb2Z0d2FyZQBJbWFnZU1hZ2ljayA3LjAuMS02IFExNiB4ODZfNjQgMjAxNi0wOS0xNyBodHRwOi8vd3d3LmltYWdlbWFnaWNrLm9yZ93ZpU4AAAAYdEVYdFRodW1iOjpEb2N1bWVudDo6UGFnZXMAMaf/uy8AAAAXdEVYdFRodW1iOjpJbWFnZTo6SGVpZ2h0ADQ4h2CHLQAAABZ0RVh0VGh1bWI6OkltYWdlOjpXaWR0aAA0OH/PR6AAAAAZdEVYdFRodW1iOjpNaW1ldHlwZQBpbWFnZS9wbmc/slZOAAAAF3RFWHRUaHVtYjo6TVRpbWUAMTI3MjIxMTIwMAkpDe8AAAASdEVYdFRodW1iOjpTaXplADUuODdLQoRSJ5sAAABbdEVYdFRodW1iOjpVUkkAZmlsZTovLy9ob21lL3d3d3Jvb3Qvc2l0ZS93d3cuZWFzeWljb24ubmV0L2Nkbi1pbWcuZWFzeWljb24uY24vc3JjLzEwOS8xMDk0Ni5wbmc6EbOHAAAAAElFTkSuQmCC"},253:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAQAAABKfvVzAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfaBBoAAAC1VYTSAAAAtklEQVQ4y92SPQrCQBCFv1lTWNtbeALxIOk9jYWexk5I6x3S2IpgYZle2OxYZP/EFSwUgq8a3s77WRgYHQRgVXhoC2wLVH6eypoFCghn3XMHQZdS+w2rBzkRBA5msmXuxVc9cgOH1rIL7gpJ0IPBxOTJMNuUT+oSBKBkZpF9QeW9CrDvBWWv/ouC31f6m09L5OSTBIeLnJ/tc4jNBA46NvG8L3SebcIGliaLN+S3N5Au6xigjBIPRFJDfNYyswsAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTYtMDktMTdUMTU6MjI6MjQrMDg6MDAD85u8AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDEwLTA0LTI2VDAwOjAwOjAwKzA4OjAwoFU7XQAAAE10RVh0c29mdHdhcmUASW1hZ2VNYWdpY2sgNy4wLjEtNiBRMTYgeDg2XzY0IDIwMTYtMDktMTcgaHR0cDovL3d3dy5pbWFnZW1hZ2ljay5vcmfd2aVOAAAAGHRFWHRUaHVtYjo6RG9jdW1lbnQ6OlBhZ2VzADGn/7svAAAAF3RFWHRUaHVtYjo6SW1hZ2U6OkhlaWdodAA0OIdghy0AAAAWdEVYdFRodW1iOjpJbWFnZTo6V2lkdGgANDh/z0egAAAAGXRFWHRUaHVtYjo6TWltZXR5cGUAaW1hZ2UvcG5nP7JWTgAAABd0RVh0VGh1bWI6Ok1UaW1lADEyNzIyMTEyMDAJKQ3vAAAAEnRFWHRUaHVtYjo6U2l6ZQA1LjQ5S0LEGrUpAAAAW3RFWHRUaHVtYjo6VVJJAGZpbGU6Ly8vaG9tZS93d3dyb290L3NpdGUvd3d3LmVhc3lpY29uLm5ldC9jZG4taW1nLmVhc3lpY29uLmNuL3NyYy8xMjIvMTIyMDUucG5naRjBHQAAAABJRU5ErkJggg=="},254:function(e,t,n){},260:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n(1),s=n(3),o=n(2),l=n(4);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var r=n(11),c=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){return r.createElement("div",{id:"map"})}},{key:"componentDidMount",value:function(){var e=window.BMap,t=new e.Map("map");window.map=t;var n=new e.Point(111.539334,30.47691);t.centerAndZoom(n,5),t.enableScrollWheelZoom(!0),t.addControl(new e.NavigationControl),t.addControl(new e.ScaleControl),t.addControl(new e.OverviewMapControl),t.addControl(new e.MapTypeControl),t.setCurrentCity("\u6b66\u6c49");var i=new e.LocalSearch(t,{renderOptions:{map:t,panel:"results"},onInfoHtmlSet:this.onInfoHtmlSet.bind(this)});window.localSearch=i}},{key:"onInfoHtmlSet",value:function(e,t){var n=this;console.log(e);var i=e.title,a=e.point,s=t.parentNode.parentNode,o=s.querySelector("a");o&&o.remove();var l=function(){n.addNode(i,a)};if(s.querySelectorAll("button").length<=0){var r=document.createElement("button"),c=document.createTextNode("\u6dfb\u52a0");return r.className="add",r.appendChild(c),r.onclick=l,void s.appendChild(r)}s.querySelector("button").onclick=l}},{key:"addNode",value:function(e,t){console.log("\u6dfb\u52a0\uff1a"+e+t);var n={name:e,lng:t.lng,lat:t.lat},i=this.props.node;i.findIndex(function(e){return e.name===n.name})<0&&(i.push(n),this.props.updateState(i))}}]),t}(r.Component),p=n(65),d=n.n(p),h=n(102),u=function(e){if(!document.querySelector("#"+e)){var t=document.createElement("div");t.id=e,t.className="mymenu",document.body.appendChild(t)}this.menu=document.querySelector("#"+e),this.menu.innerHTML=""};u.prototype.append=function(e){var t=this;e.forEach(function(e){var n=document.createElement("div");n.className="myitem",n.innerHTML=e.label,n.addEventListener("click",function(){return e.click(),t.menu.style.display="none",!1},!0),t.menu.appendChild(n)})},u.prototype.popup=function(e,t){this.menu.style.display="block",this.menu.style.top=t+"px",this.menu.style.left=e+"px"},document.body.addEventListener("click",function(){document.querySelectorAll(".mymenu").forEach(function(e){return e.style.display="none"})},!0);var m=u,f=n(11);window.algo="DFS",window.algos||(window.algos=["DFS","dijkstra"]);var A=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(o.a)(t).call(this,e))).MARGIN_LEFT=150,n.RIGHT=10,n.state={right:0,marginLeft:0,search:"\u6b66\u6c49"},n}return Object(l.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){var e=this,t=this.props.node.map(function(t){var n=t.name;return f.createElement("p",{key:n,onClick:e.nodeClick.bind(e),onContextMenu:e.ndoeMenuClick.bind(e)},n)}),n=window.algos.map(function(e,t){return f.createElement("option",{key:"algo_"+e,value:e},e+"\u7b97\u6cd5")});return f.createElement("div",{id:"sidebar",style:{marginLeft:this.state.marginLeft+"px"}},f.createElement("div",{id:"search"},f.createElement("input",{type:"text",id:"input",value:this.state.search,onChange:this.inputChange.bind(this)}),f.createElement("button",{onClick:this.searchClick.bind(this)},"\u67e5\u8be2")),f.createElement("div",{id:"nodeList"},t),f.createElement("div",{id:"algos"},f.createElement("select",{onChange:this.handleSelect.bind(this)},n)),f.createElement("div",{id:"confirm"},f.createElement("button",{onClick:this.confirmClick.bind(this)},"\u786e\u5b9a")),f.createElement("div",{id:"info"},f.createElement("button",null,"\u9000\u51fa")),f.createElement("div",{className:"drawer",style:{right:this.state.right+"px"},onClick:this.close.bind(this)}))}},{key:"handleSelect",value:function(e){console.log(e.target.value),window.algo=e.target.value,Object.is(window.algo,"dijkstra")&&(window.showDis=!0)}},{key:"close",value:function(){0!==this.state.right?this.setState({right:0,marginLeft:0}):this.setState({right:-this.RIGHT,marginLeft:-this.MARGIN_LEFT})}},{key:"inputChange",value:function(e){this.setState({search:e.target.value})}},{key:"searchClick",value:function(){window.map.clearOverlays();var e=this.state.search;window.localSearch.search(e)}},{key:"nodeClick",value:function(){}},{key:"ndoeMenuClick",value:function(e){e.preventDefault();var t=e.target.innerText,n=this,i=new m("MyMenu_Node");return i.append([{label:"\u79fb\u9664",click:function(){var e=n.props.node,i=e.findIndex(function(e){return e.name===t});i<0||(e.splice(i,1),n.props.updateState(e))}}]),i.popup(e.clientX,e.clientY),!1}},{key:"confirmClick",value:function(e){var t=this;window.map.clearOverlays(),window.layer.load(1,{shade:[.4,"#fff"]}),this.props.link.splice(0),this.loadLinks(),setTimeout(function(){return t.autoViewport()},600)}},{key:"loadLinks",value:function(){var e=this;function t(){return(t=Object(h.a)(d.a.mark(function t(){var n,i,a,s,o,l;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=Array.from(e.props.node),i=0;case 2:if(!(i<n.length)){t.next=18;break}a=n[i],s=i+1;case 5:if(!(s<n.length)){t.next=15;break}return o=n[s],console.log(a.name+"---\x3e"+o.name),t.next=10,e.loadLink(a,o);case 10:l=t.sent,e.onSearchComplete(l);case 12:s++,t.next=5;break;case 15:i++,t.next=2;break;case 18:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}(function(){return t.apply(this,arguments)})().then(function(){window.layer.closeAll()}).catch(function(e){layer.closeAll(),console.log(e),alert(e)})}},{key:"loadLink",value:function(e,t){var n=window.BMap,i=new n.Point(e.lng,e.lat),a=new n.Point(t.lng,t.lat);return new Promise(function(s,o){new n.DrivingRoute(window.map,{renderOptions:{map:null,autoViewport:!1},onSearchComplete:function(n){s({results:n,node1:e,node2:t})}}).search(i,a)})}},{key:"searchRoute",value:function(e,t){}},{key:"onSearchComplete",value:function(e){var t=e.results,n=e.node1,i=e.node2,a=t.getPlan(0),s=a.getDistance(!0),o=a.getRoute(0).getPath(),l=new window.BMap.Polyline(o);window.map.addOverlay(l),this.setLink(n,i,s,l)}},{key:"setLink",value:function(e,t,n,i){var a=this.props.link;a.push({node1:e,node2:t,dis:n,polyline:i}),this.props.updateState(null,a)}},{key:"autoViewport",value:function(){var e=this.props.node,t=[];e.forEach(function(e){var n=window.BMap,i=new n.Point(e.lng,e.lat);t.push(i);var a=new n.Marker(i,{title:e.name}),s=new n.Label(e.name,{offset:new n.Size(20,-10)});a.setLabel(s),window.map.addOverlay(a)});var n=window.map.getViewport(t);window.map.centerAndZoom(n.center,n.zoom)}}]),t}(f.Component),v=n(15),y={onObj:{},oneObj:{},on:function(e,t){void 0===this.onObj[e]&&(this.onObj[e]=[]),this.onObj[e].push(t)},one:function(e,t){void 0===this.oneObj[e]&&(this.oneObj[e]=[]),this.oneObj[e].push(t)},off:function(e){this.onObj[e]=[],this.oneObj[e]=[]},trigger:function(){var e,t;if(0==arguments.length)return!1;if(e=arguments[0],t=[].concat(Array.prototype.slice.call(arguments,1)),void 0!==this.onObj[e]&&this.onObj[e].length>0)for(var n in this.onObj[e])this.onObj[e][n].apply(null,t);if(void 0!==this.oneObj[e]&&this.oneObj[e].length>0){for(var i in this.oneObj[e])this.oneObj[e][i].apply(null,t),this.oneObj[e][i]=void 0;this.oneObj[e]=[]}}},g=n(11),E=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(o.a)(t).call(this,e))).state={tab:1,code:"",actions:[]},n.SELECTED_LINK_COLOR="#ff0000",n.DEFAULT_LINK_COLOR="#3a6bdb",n.onShowCode=n.onShowCode.bind(Object(v.a)(Object(v.a)(n))),n.onShowAction=n.onShowAction.bind(Object(v.a)(Object(v.a)(n))),n}return Object(l.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){var e=this.setContent(this.props);return g.createElement("div",{style:{width:"100%",height:"100%"}},g.createElement("div",{id:"tab"},g.createElement("div",{style:{backgroundColor:1===this.state.tab?"#999":"#CCC"},onClick:this.setPTab.bind(this)},"\u9876\u70b9"),g.createElement("div",{style:{backgroundColor:2===this.state.tab?"#999":"#CCC"},onClick:this.setLTab.bind(this)},"\u8fb9"),g.createElement("div",{style:{backgroundColor:3===this.state.tab?"#999":"#CCC"},onClick:this.setMatrixTab.bind(this)},"\u77e9\u9635"),g.createElement("div",{style:{backgroundColor:4===this.state.tab?"#999":"#CCC"},onClick:this.setCodeTab.bind(this)},"\u4ee3\u7801"),g.createElement("div",{style:{backgroundColor:5===this.state.tab?"#999":"#CCC"},onClick:this.setActionTab.bind(this)},"\u52a8\u4f5c")),g.createElement("div",{id:"tabContent"},e))}},{key:"onShowCode",value:function(e){this.setState({code:e})}},{key:"onShowAction",value:function(e){this.setState({actions:e})}},{key:"componentDidMount",value:function(){y.on(window.showCode,this.onShowCode),y.on(window.showAction,this.onShowAction)}},{key:"setPTab",value:function(){this.setState({tab:1})}},{key:"setLTab",value:function(){this.setState({tab:2})}},{key:"setMatrixTab",value:function(){this.setState({tab:3})}},{key:"setCodeTab",value:function(){this.setState({tab:4})}},{key:"setActionTab",value:function(){this.setState({tab:5})}},{key:"setContent",value:function(e){var t=e.node,n=e.link;switch(this.state.tab){case 1:return this.renderPoint(t);case 2:return this.renderLink(n);case 3:return this.renderMatrix(t,n);case 4:return this.renderCode();case 5:return this.renderAction()}return"ERROR"}},{key:"renderPoint",value:function(e){var t=e.map(function(e){return g.createElement("tr",{key:e.name},g.createElement("td",null,e.name),g.createElement("td",null,e.lng),g.createElement("td",null,e.lat))});return g.createElement("table",null,g.createElement("thead",null,g.createElement("tr",null,g.createElement("th",null,"\u5730\u70b9"),g.createElement("th",null,"\u7ecf\u5ea6"),g.createElement("th",null,"\u7eac\u5ea6"))),g.createElement("tbody",null,t))}},{key:"renderLink",value:function(e){var t=this,n=e.map(function(e,n){var i=e.polyline.isVisible(),a=e.polyline.getStrokeColor()===t.SELECTED_LINK_COLOR;return g.createElement("tr",{key:e+"-"+n,onClick:t.highlightLink(e).bind(t),style:{backgroundColor:a?"#DDD":"#FFF"}},g.createElement("td",null,e.node1.name+" -> "+e.node2.name),g.createElement("td",null,e.dis),g.createElement("td",{onClick:t.setLink(e).bind(t)},i?"Yes":"No"))});return g.createElement("table",null,g.createElement("thead",null,g.createElement("tr",null,g.createElement("th",null,"\u8def\u7ebf"),g.createElement("th",null,"\u8ddd\u79bb"),g.createElement("th",null,"\u9009\u62e9"))),g.createElement("tbody",null,n))}},{key:"renderMatrix",value:function(e,t){var n=g.createElement("th",null),i=e.map(function(e){return g.createElement("th",null,e.name)}),a=e.map(function(n){var i=g.createElement("th",null,n.name),a=n.name,s=e.map(function(e){for(var n,i=0,s=0;s<t.length;s++)(t[s].polyline.isVisible()&&a==t[s].node1.name&&e.name==t[s].node2.name||a==t[s].node2.name&&e.name==t[s].node1.name)&&(n=t[s].dis,i=1);return 1==i?g.createElement("td",{align:"center"},n):g.createElement("td",{align:"center"},"\u221e")});return g.createElement("tr",null,i,s)});return g.createElement("table",null,n,i,a)}},{key:"renderCode",value:function(){return g.createElement("textarea",{cols:"80",rows:"30",value:this.state.code,autoFocus:!0,readOnly:!0})}},{key:"renderAction",value:function(){var e=this.state.actions;console.log(e);var t=e.map(function(e,t){return g.createElement("tr",{key:t},g.createElement("td",{align:"center"},e))});return g.createElement("table",null,t)}},{key:"highlightLink",value:function(e){return function(t){var n=this,i=this.props.link;i.forEach(function(e){e.polyline.setStrokeColor(n.DEFAULT_LINK_COLOR)}),e.polyline.setStrokeColor(this.SELECTED_LINK_COLOR),this.props.updateState(null,i)}}},{key:"setLink",value:function(e){return function(t){var n=this.props.link;e.polyline.isVisible()?e.polyline.hide():e.polyline.show(),this.props.updateState(null,n)}}}]),t}(g.Component),b=n(66),O=n(39);n(7);n(252),n(253);var w=n(11),k=window.jQuery,S=null,C=[],L={},_=1;window.question=!0;var N=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(o.a)(t).call(this,e))).state={},n.DEFAULT_LINK_COLOR="#3a6bdb",n.INITIAL_LINK_COLOR="#0a0a0a",n.INITIAL_NODE_COLOR="#5B9BD5",n.SELECTED_LINK_COLOR="#ff0000",n.SELECTED_NODE_COLOR="#ff0000",n.state.speed=.5,n.state.play="stop",n.state.start="",n.state.end="",n.state.S_NODE=new Map,n.state.S_EDGE=new Map,n.state.question=!0,n.state.S_NODE_DIS=new Map,n.state.S_NODE_INFO=new Map,n}return Object(l.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){this.clcMaxMin();var e=this.renderNode(),t=this.renderLink(),n="play"===this.state.play?"pauseState":"playState";return w.createElement("div",{id:"graphWrap"},w.createElement("div",{id:"main"},w.createElement("div",{style:{width:"100%",height:"100%",backgroundColor:"#FFF"}},w.createElement("svg",{ref:"graph",width:"100%",height:"100%",version:"1.1",xmlns:"http://www.w3.org/2000/svg",onContextMenu:function(e){e.preventDefault()}},t,e))),w.createElement("div",{id:"tool"},w.createElement("div",{id:"question"}," \u63d0\u95ee ",w.createElement("input",{id:"question_checkbox",type:"checkbox",checked:this.state.question,onChange:this.checkChange.bind(this)})," "),w.createElement("div",{id:"speed",title:"\u901f\u5ea6",onClick:this.changeSpeed.bind(this)},w.createElement("div",{id:"speedValue",style:{width:100*this.state.speed+"%"}})),w.createElement("div",{id:"prev",title:"\u4e0a\u4e00\u6b65",onClick:this.animate_back.bind(this)}),w.createElement("div",{id:"start",title:"\u5f00\u59cb/\u6682\u505c",className:n,onClick:this.play.bind(this)}),w.createElement("div",{id:"next",title:"\u4e0b\u4e00\u6b65",onClick:this.animate_forward.bind(this)}),w.createElement("div",{id:"end",title:"\u7ed3\u675f",onClick:this.stop.bind(this)}),w.createElement("div",{id:"reset",title:"\u590d\u4f4d",onClick:this.reSet.bind(this)})))}},{key:"reSet",value:function(){S=null,C=[],L={},_=1,window.question=!0,this.resetColor(),this.state.speed=.5,this.state.play="stop",this.state.start="",this.state.end="",this.state.S_NODE=new Map,this.state.S_EDGE=new Map,this.state.question=!0,this.state.S_NODE_DIS=new Map,this.state.S_NODE_INFO=new Map}},{key:"checkChange",value:function(e){window.question=e.target.checked,console.log(window.question),this.setState({question:!this.state.question})}},{key:"clcMaxMin",value:function(){var e=this,t=-1/0,n=1/0,i=-1/0,a=1/0;this.mid_lng=0,this.mid_lat=0,this.props.node.forEach(function(s){s.lat>i&&(i=s.lat),s.lat<a&&(a=s.lat),s.lng>t&&(t=s.lng),s.lng<n&&(n=s.lng),e.mid_lng+=s.lng,e.mid_lat+=s.lat}),this.max_lng=t,this.min_lng=n,this.max_lat=i,this.min_lat=a,this.mid_lng/=this.props.node.length,this.mid_lat/=this.props.node.length}},{key:"clcCoordinate",value:function(e,t){var n=this.refs.graph.clientWidth,i=this.refs.graph.clientHeight;return[n=(n-50-50)/(this.max_lng-this.min_lng+.001)*(e-this.min_lng)+50,i-=(i-50-50)/(this.max_lat-this.min_lat+.001)*(t-this.min_lat)+50]}},{key:"renderNode",value:function(){var e=this;return this.props.node.map(function(t){var n=e.clcCoordinate(t.lng,t.lat),i=Object(O.a)(n,2),a=i[0],s=i[1],o=t.name,l=e.setSE.bind(e),r=null,c="",p="";e.state.start===t.name&&(r="#CCFFFF"),e.state.end===t.name&&(r="#CC6699"),e.state.S_NODE.has(t.name)&&(r=e.state.S_NODE.get(t.name)),e.state.S_NODE_DIS.has(t.name)&&(c=e.state.S_NODE_DIS.get(t.name)),e.state.S_NODE_INFO.has(t.name)&&(p=e.state.S_NODE_INFO.get(t.name));var d={name:o,x:a,y:s,setSE:l,color:r,distance:c,info:p};return w.createElement(I,Object.assign({key:"node"+t.name},d))})}},{key:"renderLink",value:function(){var e=this;return this.props.link.map(function(t){if(t.polyline.isVisible()){var n=e.clcCoordinate(t.node1.lng,t.node1.lat),i=Object(O.a)(n,2),a=i[0],s=i[1],o=e.clcCoordinate(t.node2.lng,t.node2.lat),l=Object(O.a)(o,2),r=l[0],c=l[1],p={name:t.node1.name,x:a,y:s},d={name:t.node2.name,x:r,y:c},h=t.polyline.getStrokeColor(),u="",m=!0,f=!1,A=void 0;try{for(var v,y=e.state.S_EDGE[Symbol.iterator]();!(m=(v=y.next()).done);m=!0){var g=v.value;if(t.node1.name===g[1][0]&&t.node2.name===g[1][1]||t.node1.name===g[1][1]&&t.node2.name===g[1][0]){u=g[0];break}}}catch(E){f=!0,A=E}finally{try{m||null==y.return||y.return()}finally{if(f)throw A}}return console.log(h,t),w.createElement(D,{key:"link-"+p.name+"-"+d.name,from:p.name,to:d.name,x1:p.x,y1:p.y,x2:d.x,y2:d.y,color:h,distance:u})}})}},{key:"changeSpeed",value:function(e){var t=(e.clientX-this.getLeft(e.target))/e.target.clientWidth;console.log(t),this.setState({speed:t})}},{key:"play",value:function(e){"stop"===this.state.play?(this.setState({play:"play"}),clearTimeout(window.timer),this.go()):"pause"===this.state.play?(this.setState({play:"play"}),this.animate()):"play"===this.state.play&&(this.setState({play:"pause"}),clearTimeout(window.timer))}},{key:"stop",value:function(){clearTimeout(window.timer),L.STEP_COUNT=1,this.setState({play:"stop",start:"",end:""}),layer.msg("\u7ed3\u675f")}},{key:"codeChangeHandler",value:function(e){y.trigger(window.showCode,e)}},{key:"actionGetHandler",value:function(e){y.trigger(window.showAction,e)}},{key:"go",value:function(){var e=this;if(!this.state.start||!this.state.end)return this.setState({play:"stop"}),this.stop();var t=this,n=[],i=[],a=[];C=[],this.props.node.forEach(function(e){C.push(e.name);var t=parseInt(e.lng),n=parseInt(e.lat),a="*"+(C.length-1)+"*";i.push([a,t,n])}),i=JSON.stringify(i);var s="*"+C.findIndex(function(t){return t===e.state.start})+"*",o="*"+C.findIndex(function(t){return t===e.state.end})+"*";a.push([i.length]),a.push([-1e3,1e3]),a.push([1e3,-1e3]),a=JSON.stringify(a),t.resetColor();var l=new Map,r=new Map,c=new Map,p=new Map;this.setState({S_NODE:l,S_EDGE:r,S_NODE_DIS:c,S_NODE_INFO:p}),this.props.link.forEach(function(e){if(e.polyline.isVisible()){var t="*"+C.findIndex(function(t){return t===e.node1.name})+"*",i="*"+C.findIndex(function(t){return t===e.node2.name})+"*";n.push([t,i,parseFloat(e.dis,10)])}}),n=JSON.stringify(n),window.layer.load(1,{shade:[.4,"#fff"]}),k.ajax({type:"POST",url:"/data",data:{edgeIn:n,pointIn:i,globalIn:a,sName:s,eName:o,algo:window.algo},success:function(e){S=e,layer.closeAll();for(var n=[],i=0;i<S.steps.length-1;i++){var a=S.steps[i].split("\t")[3];"Question"===S.steps[i].split("\t")[1].split("(")[0]&&(a=S.steps[i].split("\t")[7]),a in L?L[a].push(i):(L[a]=[],L[a].push(i)),n.push(S.steps[i].split("\t")[1])}t.actionGetHandler(n),t.animate()},error:function(){layer.closeAll(),layer.msg("\u51fa\u9519, \u63d0\u4ea4\u5931\u8d25")}})}},{key:"animate",value:function(){var e=this;window.timer=setTimeout(function(){var t=e.getStep(_);if(layer.closeAll(),_++,null!==t){for(var n=e.props.link,i=e.state.S_NODE,a=e.state.S_EDGE,s=e.state.S_NODE_DIS,o=e.state.S_NODE_INFO,l=0;l<t.types.length;l++)if("changeEdgeColor"===t.types[l])!function(){var i=t.infos[l][1].split("(")[1].split(",");i.pop();var a=t.infos[l][1].split("RGB")[1];a=e.chooseColor(a);var s=C[parseInt(i[0])],o=C[parseInt(i[1])];n.forEach(function(e){e.polyline.isVisible()&&(e.node1.name===s&&e.node2.name===o||e.node1.name===o&&e.node2.name===s)&&e.polyline.setStrokeColor(a)})}();else if("changeNodeColor"===t.types[l]){var r=t.infos[l][1].split("(")[1].split(",")[0];r=parseInt(r);var c=t.infos[l][1].split("RGB")[1];c=e.chooseColor(c);var p=C[r];i.set(p,c)}else if("changeEdgeLength"===t.types[l]){var d=t.infos[l][1].split("(")[1].split(")")[0].split(","),h=C[parseInt(d[0])],u=C[parseInt(d[1])],m=parseFloat(d[2]);a.set(m,[h,u])}else if("changeNodeDist"===t.types[l]){d=t.infos[l][1].split("(")[1].split(")")[0].split(",");var f=parseInt(d[0]),A=parseFloat(d[1]),v=C[f];s.set(v,A)}else if("showCode"===t.types[l]){var y=e,g="code"+t.infos[l][1].split("(")[1].split(")")[0]+".txt";k.ajax({type:"POST",url:"/code",data:{codeName:g},success:function(e){y.codeChangeHandler(e)},error:function(){console.log("\u83b7\u53d6\u4ee3\u7801\u5931\u8d25\uff01")}})}else if("showHelp"===t.types[l]){var E=t.infos[l][1].split("(")[1].split(")")[0];layer.msg(E,{time:3e3*e.state.speed+70})}else{if("Question"===t.types[l]&&window.question){var b=t.infos[l][2];"*"===b[0]&&(b=(b=b.replace(/\*/g,"")).replace(b[0],C[b[0]]));var O=t.infos[l][3];if("*"===O[0])return O=O.replace(/\*/g,""),O=C[O],e.ask(b,O);if(Object.is(window.algo,"dijkstra"))return e.ask(b,O);for(var w=parseInt(O),S=[],L=O.length;L>=1;)S.push(w%10),w=parseInt(w/10),L--;for(var N=void 0,I=S.length-1;I>=0;I--)I==S.length-1?N=C[S[I]]+"->":0==I?N+=C[S[I]]:N=N+C[S[I]]+"->";return e.ask(b,N)}if("showInequality"===t.types[l]){d=t.infos[l][1].split("(")[1].split(")")[0].split(",");var D=parseInt(d[0]),j=d[1],T=C[D];o.set(T,j)}else if("InequalityDisapper"===t.types[l]){d=t.infos[l][1].split("(")[1].split(")")[0].split(",");var R=parseInt(d[0]),x=C[R];o.set(x,"")}}e.props.updateState(null,n),e.setState({S_NODE:i,S_EDGE:a,S_NODE_DIS:s,S_NODE_INFO:o}),e.animate()}else e.stop()},3e3*this.state.speed+70)}},{key:"getStep",value:function(e){console.log("get step:"+e);var t=new Array,n=new Array;if(e in L){for(var i=0;i<L[e].length;i++){var a=S.steps[L[e][i]].split("\t"),s=a[1].split("(")[0];t.push(s),n.push(a)}return{types:t,infos:n}}return null}},{key:"chooseColor",value:function(e){switch(e){case"(10,10,10))":return this.INITIAL_LINK_COLOR;case"(91,155,213))":return this.INITIAL_NODE_COLOR;case"(255,0,0))":return this.SELECTED_LINK_COLOR;default:return"#000000"}}},{key:"checkLink",value:function(e,t,n){var i=e.node1,a=e.node2;return i.name===t&&a.name===n||i.name===n&&a.name===t}},{key:"resetColor",value:function(){var e=this,t=this.props.link;t.forEach(function(t){t.polyline.isVisible()&&t.polyline.setStrokeColor(e.DEFAULT_LINK_COLOR)}),this.props.updateState(null,t)}},{key:"getLeft",value:function(e){var t=e.offsetLeft;return null!=e.offsetParent&&(t+=this.getLeft(e.offsetParent)),t}},{key:"setSE",value:function(e){e.preventDefault(),e.stopPropagation();var t=this,n=e.target.attributes.id.value.split("_").pop(),i=new m("MyMenu_Node_SVG");return i.append([{label:"\u8bbe\u4e3a\u8d77\u70b9",click:function(){t.setState({start:n})}},{label:"\u8bbe\u4e3a\u7ec8\u70b9",click:function(){t.setState({end:n})}}]),i.popup(e.clientX,e.clientY),!1}},{key:"ask",value:function(e,t){clearTimeout(window.timer);var n=this;window.layer.prompt({title:e},function(i,a){layer.closeAll(),i!=t?(window.layer.msg("\u6b63\u786e\u7b54\u6848\uff1a"+t,{time:1e3}),k.ajax({type:"POST",url:"/collect",data:{que:e,ans:i,msg:t},success:function(e){},error:function(){}}),setTimeout(function(){n.animate()},1100)):(window.layer.msg("\u7b54\u5bf9\u4e86\uff01",{time:1e3}),n.animate())})}},{key:"animate_back",value:function(){var e=this;this.setState({play:"pause"}),clearTimeout(window.timer),layer.closeAll(),_--;var t=this.getStep(_);if(null!==t){for(var n=this.props.link,i=this.state.S_NODE,a=this.state.S_EDGE,s=this.state.S_NODE_DIS,o=this.state.S_NODE_INFO,l=0;l<t.types.length;l++)if(console.log(t.infos[l]),"changeEdgeColor"===t.types[l])!function(){var i=t.infos[l][1].split("(")[1].split(",");i.pop();var a=e.INITIAL_LINK_COLOR,s=C[parseInt(i[0])],o=C[parseInt(i[1])];n.forEach(function(e){e.polyline.isVisible()&&(e.node1.name===s&&e.node2.name===o||e.node1.name===o&&e.node2.name===s)&&e.polyline.setStrokeColor(a)})}();else if("changeNodeColor"===t.types[l]){var r=t.infos[l][1].split("(")[1].split(",")[0];r=parseInt(r);var c=this.INITIAL_NODE_COLOR,p=C[r];i.set(p,c)}else if("changeEdgeLength"===t.types[l]){var d=t.infos[l][1].split("(")[1].split(")")[0].split(","),h=C[parseInt(d[0])],u=C[parseInt(d[1])],m=parseFloat(d[2]);a.set(m,[h,u])}else if("changeNodeDist"===t.types[l]){d=t.infos[l][1].split("(")[1].split(")")[0].split(",");var f=parseInt(d[0]),A=parseFloat(d[1]),v=C[f];s.set(v,A)}else if("showCode"===t.types[l]){var y=this,g="code"+t.infos[l][1].split("(")[1].split(")")[0]+".txt";k.ajax({type:"POST",url:"/code",data:{codeName:g},success:function(e){y.codeChangeHandler(e)},error:function(){console.log("\u83b7\u53d6\u4ee3\u7801\u5931\u8d25\uff01")}})}else if("showHelp"===t.types[l]){var E=t.infos[l][1].split("(")[1].split(")")[0];layer.msg(E,{time:3e6*this.state.speed+70})}else{if("Question"===t.types[l]&&window.question){var b=t.infos[l][2],O=t.infos[l][3];return"*"===O[0]&&(O=O.replace(/\*/g,""),O=C[O]),this.ask(b,O)}if("showInequality"===t.types[l]){d=t.infos[l][1].split("(")[1].split(")")[0].split(",");var w=parseInt(d[0]),S=d[1],L=C[w];o.set(L,S)}else if("InequalityDisapper"===t.types[l]){d=t.infos[l][1].split("(")[1].split(")")[0].split(",");var N=parseInt(d[0]),I=C[N];o.set(I,"")}}this.props.updateState(null,n),this.setState({S_NODE:i,S_EDGE:a,S_NODE_DIS:s,S_NODE_INFO:o})}else this.stop()}},{key:"animate_forward",value:function(){var e=this;this.setState({play:"pause"}),clearTimeout(window.timer),layer.closeAll(),_++;var t=this.getStep(_);if(null!==t){for(var n=this.props.link,i=this.state.S_NODE,a=this.state.S_EDGE,s=this.state.S_NODE_DIS,o=this.state.S_NODE_INFO,l=0;l<t.types.length;l++)if("changeEdgeColor"===t.types[l])!function(){var i=t.infos[l][1].split("(")[1].split(",");i.pop();var a=t.infos[l][1].split("RGB")[1];a=e.chooseColor(a);var s=C[parseInt(i[0])],o=C[parseInt(i[1])];n.forEach(function(e){e.polyline.isVisible()&&(e.node1.name===s&&e.node2.name===o||e.node1.name===o&&e.node2.name===s)&&e.polyline.setStrokeColor(a)})}();else if("changeNodeColor"===t.types[l]){var r=t.infos[l][1].split("(")[1].split(",")[0];r=parseInt(r);var c=t.infos[l][1].split("RGB")[1];c=this.chooseColor(c);var p=C[r];i.set(p,c)}else if("changeEdgeLength"===t.types[l]){var d=t.infos[l][1].split("(")[1].split(")")[0].split(","),h=C[parseInt(d[0])],u=C[parseInt(d[1])],m=parseFloat(d[2]);a.set(m,[h,u])}else if("changeNodeDist"===t.types[l]){d=t.infos[l][1].split("(")[1].split(")")[0].split(",");var f=parseInt(d[0]),A=parseFloat(d[1]),v=C[f];s.set(v,A)}else if("showCode"===t.types[l]){var y=this,g="code"+t.infos[l][1].split("(")[1].split(")")[0]+".txt";k.ajax({type:"POST",url:"/code",data:{codeName:g},success:function(e){y.codeChangeHandler(e)},error:function(){console.log("\u83b7\u53d6\u4ee3\u7801\u5931\u8d25\uff01")}})}else if("showHelp"===t.types[l]){var E=t.infos[l][1].split("(")[1].split(")")[0];layer.msg(E,{time:3e5*this.state.speed+70})}else{if("Question"===t.types[l]&&window.question){var b=t.infos[l][2],O=t.infos[l][3];return"*"===O[0]&&(O=O.replace(/\*/g,""),O=C[O]),this.ask(b,O)}if("showInequality"===t.types[l]){d=t.infos[l][1].split("(")[1].split(")")[0].split(",");var w=parseInt(d[0]),S=d[1],L=C[w];o.set(L,S)}else if("InequalityDisapper"===t.types[l]){d=t.infos[l][1].split("(")[1].split(")")[0].split(",");var N=parseInt(d[0]),I=C[N];o.set(I,"")}}this.props.updateState(null,n),this.setState({S_NODE:i,S_EDGE:a,S_NODE_DIS:s,S_NODE_INFO:o})}else this.stop()}}]),t}(w.Component),I=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(o.a)(t).call(this,e))).SELECT_COLOR="#300",n.DEFAULT_COLOR="#3C9",n}return Object(l.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){return w.createElement("g",{id:"node_"+this.props.name,onContextMenu:this.props.setSE},w.createElement("circle",{id:"node_circle_"+this.props.name,cx:this.props.x,cy:this.props.y,r:this.props.r||20,fill:this.props.color||this.DEFAULT_COLOR}),w.createElement("text",{id:"node_text_"+this.props.name,x:this.props.x,y:this.props.y,fill:"black",textAnchor:"middle",dominantBaseline:"middle",style:{fontSize:"13px"}},this.props.hide||this.props.name),w.createElement("text",Object(b.a)({id:"node_value"+this.props.name,x:this.props.x,y:this.props.y+10,fill:"black",textAnchor:"middle",dominantBaseline:"middle",fontSize:"13px"},"fill","blue"),this.props.distance),w.createElement("text",Object(b.a)({id:"node_value"+this.props.name,x:this.props.x+40,y:this.props.y-5,fill:"black",textAnchor:"middle",dominantBaseline:"middle",fontSize:"13px"},"fill","black"),this.props.info))}},{key:"hover",value:function(e){console.log(e.target.attributes.fill),console.log(e.target.attributes);e.target.attributes}}]),t}(w.Component),D=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(o.a)(t).call(this,e))).SELECT_COLOR="#900",n.DEFAULT_COLOR=n.props.color,n}return Object(l.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){return this.DEFAULT_COLOR=this.props.color,w.createElement("g",{id:"link_"+this.props.from+"_"+this.props.to},w.createElement("line",{x1:this.props.x1,y1:this.props.y1,x2:this.props.x2,y2:this.props.y2,stroke:this.props.color,strokeWidth:"5",style:{cursor:"pointer"},onMouseEnter:this.hover.bind(this),onMouseLeave:this.hover.bind(this)}),w.createElement("text",{x:(this.props.x1+this.props.x2)/2,y:(this.props.y1+this.props.y2)/2,style:{fontSize:"15px"}},this.props.distance))}},{key:"hover",value:function(e){var t=e.target.attributes;t.stroke.value===this.SELECT_COLOR?t.stroke.value=this.DEFAULT_COLOR:t.stroke.value=this.SELECT_COLOR}}]),t}(w.Component),j=N,T=n(11),R=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(o.a)(t).call(this,e))).MARGIN_RIGHT=600,n.LEFT=10,n.state={left:-n.LEFT,marginRight:-n.MARGIN_RIGHT},n}return Object(l.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){return T.createElement("div",{id:"panel",style:{marginRight:this.state.marginRight+"px"}},T.createElement("div",{id:"graph"},T.createElement(j,this.props)),T.createElement("div",{id:"table"},T.createElement(E,this.props)),T.createElement("div",{className:"drawer",style:{left:this.state.left+"px"},onClick:this.close.bind(this)}))}},{key:"close",value:function(){0!==this.state.left?this.setState({left:0,marginRight:0}):this.setState({left:-this.LEFT,marginRight:-this.MARGIN_RIGHT})}}]),t}(T.Component);n(254);var x=n(11),M=n(256);window.MyMenu=m,window.showCode="showCode",window.showAction="showAction";var F=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(o.a)(t).call(this,e))).state={node:[],link:[]},n}return Object(l.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){return x.createElement("div",{id:"container"},x.createElement(A,{updateState:this.updateState.bind(this),node:this.state.node,link:this.state.link}),x.createElement(c,{updateState:this.updateState.bind(this),node:this.state.node,link:this.state.link}),x.createElement(R,{updateState:this.updateState.bind(this),node:this.state.node,link:this.state.link}))}},{key:"updateState",value:function(e,t){var n=this.state.node,i=this.state.link;this.setState({node:e||n,link:t||i})}}]),t}(x.Component);M.render(x.createElement(F,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[103,2,1]]]);
//# sourceMappingURL=main.cc56cdd6.chunk.js.map