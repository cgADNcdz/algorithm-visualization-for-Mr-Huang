{"ast":null,"code":"import _defineProperty from \"/home/cdz/Code/FrontEnd/nw-react/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/home/cdz/Code/FrontEnd/nw-react/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _classCallCheck from \"/home/cdz/Code/FrontEnd/nw-react/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/cdz/Code/FrontEnd/nw-react/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/cdz/Code/FrontEnd/nw-react/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/cdz/Code/FrontEnd/nw-react/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/cdz/Code/FrontEnd/nw-react/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/cdz/Code/FrontEnd/nw-react/src/app/component/GraphSVG.js\";\n//import d3 from './d3.v4.min.js';\n//window.d3 = d3;\n//import $ from 'jquery';  //引入jquery\nimport Graph from \"./Graph.js\";\nimport MyMenu from \"../MyMenu.js\";\nimport eventProxy from \"../eventProxy.js\";\nimport { assertFunctionParent } from \"babel-types\";\n\nrequire('../../assets/play.png');\n\nrequire('../../assets/pause.png');\n\nvar React = require('react'); //readme: 学长的代码中node的改变是通过state.S_NODE实现，edge(颜色)的改变是通过this.props.link实现!!!!!\n//经补充修改后，边上路径长度的改变通过state.S_EDGE实现\n//import stepData from \"./testData.js\";\n\n\nvar $ = window.jQuery;\nvar stepData = null;\nvar _name = []; //存储点名\n//let STEP_COUNT = 0;　　　//学长以STEP_COUNT记录每一个动作的编号（是动作不是帧！！）->改为每一帧的编号\n\nvar actionStep = {}; //用于存储步骤动作信息,eg:   {3:[3,4,5,6]}表示第三帧包含动作3、4、５＼６\n\nvar STEP_COUNT = 1; //全局记录当前演示的帧数\n\nwindow.question = true;\n\nvar GraphSVG =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(GraphSVG, _React$Component);\n\n  //其属性来自Panel...this.pros的传递,包括updtaState、node、link\n  function GraphSVG(props) {\n    var _this;\n\n    _classCallCheck(this, GraphSVG);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(GraphSVG).call(this, props));\n    _this.state = {}; //注意：关于点、边的颜色\n    //ＤＦＳ后台传递的颜色：初始化边表示（１０，１０，１０），初始点表示(91,155,2１3),选中点边表示（255,0,0）\n    //DJ后台传递颜色:初始化边（１０，１０，１０），初始化点（９１，１５５，２１３），\n\n    _this.DEFAULT_LINK_COLOR = \"#3a6bdb\"; //默认是(浅蓝色)\n\n    _this.INITIAL_LINK_COLOR = \"#0a0a0a\"; //初始化后边的颜色\n\n    _this.INITIAL_NODE_COLOR = \"#5B9BD5\"; //初始化后点的颜色\n\n    _this.SELECTED_LINK_COLOR = \"#ff0000\"; //选中的边，红色\n\n    _this.SELECTED_NODE_COLOR = \"#ff0000\"; //选中的点     \n\n    _this.path = null;\n    _this.state.speed = 0.5;\n    _this.state.play = \"stop\";\n    _this.state.start = \"\";\n    _this.state.end = \"\";\n    _this.state.S_NODE = new Map(); //更新点的颜色;　　　　　　　　　Map是一组键值对的结构，具有极快的查找速度(误以为是Map.js导出的Map类)\n\n    _this.state.S_EDGE = new Map(); //更新边的距离\n\n    _this.state.question = true;\n    _this.state.S_NODE_DIS = new Map(); //更新点到起点的距离\n\n    _this.state.S_NODE_INFO = new Map(); //更新点旁边的其他信息，如显示不等式\n\n    return _this;\n  }\n\n  _createClass(GraphSVG, [{\n    key: \"render\",\n    value: function render() {\n      this.clcMaxMin();\n      var nodes = this.renderNode();\n      var links = this.renderLink();\n      var controlstate = this.state.play === \"play\" ? \"pauseState\" : \"playState\";\n      return React.createElement(\"div\", {\n        id: \"graphWrap\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        id: \"main\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          width: \"100%\",\n          height: \"100%\",\n          backgroundColor: \"#FFF\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63\n        },\n        __self: this\n      }, React.createElement(\"svg\", {\n        ref: \"graph\",\n        width: \"100%\",\n        height: \"100%\",\n        version: \"1.1\",\n        xmlns: \"http://www.w3.org/2000/svg\",\n        onContextMenu: function onContextMenu(e) {\n          e.preventDefault();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 64\n        },\n        __self: this\n      }, links, nodes))), React.createElement(\"div\", {\n        id: \"tool\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        id: \"question\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71\n        },\n        __self: this\n      }, \" \\u63D0\\u95EE \", React.createElement(\"input\", {\n        id: \"question_checkbox\",\n        type: \"checkbox\",\n        checked: this.state.question,\n        onChange: this.checkChange.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71\n        },\n        __self: this\n      }), \" \"), React.createElement(\"div\", {\n        id: \"speed\",\n        title: \"\\u901F\\u5EA6\",\n        onClick: this.changeSpeed.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        id: \"speedValue\",\n        style: {\n          width: this.state.speed * 100 + \"%\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        id: \"prev\",\n        title: \"\\u4E0A\\u4E00\\u6B65\",\n        onClick: this.animate_back.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        id: \"start\",\n        title: \"\\u5F00\\u59CB/\\u6682\\u505C\",\n        className: controlstate,\n        onClick: this.play.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        id: \"next\",\n        title: \"\\u4E0B\\u4E00\\u6B65\",\n        onClick: this.animate_forward.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        id: \"end\",\n        title: \"\\u7ED3\\u675F\",\n        onClick: this.stop.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78\n        },\n        __self: this\n      })));\n    } //是否提问状态改变\n\n  }, {\n    key: \"checkChange\",\n    value: function checkChange(e) {\n      window.question = e.target.checked;\n      console.log(window.question);\n      this.setState({\n        question: !this.state.question\n      });\n    }\n  }, {\n    key: \"clcMaxMin\",\n    value: function clcMaxMin() {\n      var _this2 = this;\n\n      var max_lng = -Infinity,\n          min_lng = Infinity;\n      var max_lat = -Infinity,\n          min_lat = Infinity;\n      this.mid_lng = 0;\n      this.mid_lat = 0;\n      this.props.node.forEach(function (node) {\n        if (node.lat > max_lat) max_lat = node.lat;\n        if (node.lat < min_lat) min_lat = node.lat;\n        if (node.lng > max_lng) max_lng = node.lng;\n        if (node.lng < min_lng) min_lng = node.lng;\n        _this2.mid_lng += node.lng;\n        _this2.mid_lat += node.lat;\n      });\n      this.max_lng = max_lng;\n      this.min_lng = min_lng;\n      this.max_lat = max_lat;\n      this.min_lat = min_lat;\n      this.mid_lng /= this.props.node.length;\n      this.mid_lat /= this.props.node.length;\n    }\n  }, {\n    key: \"clcCoordinate\",\n    value: function clcCoordinate(lng, lat) {\n      var w = this.refs.graph.clientWidth;\n      var h = this.refs.graph.clientHeight;\n      var margin = 50; // w = (w-margin - margin)/(this.max_lat-this.min_lat + 0.001)*(lat-this.min_lat) + margin;\n      // h = h - ( (h-margin - margin)/(this.max_lng-this.min_lng + 0.001)*(lng-this.min_lng) + margin ) ;\n\n      w = (w - margin - margin) / (this.max_lng - this.min_lng + 0.001) * (lng - this.min_lng) + margin;\n      h = h - ((h - margin - margin) / (this.max_lat - this.min_lat + 0.001) * (lat - this.min_lat) + margin);\n      return [w, h];\n    }\n  }, {\n    key: \"renderNode\",\n    value: function renderNode() {\n      var _this3 = this;\n\n      var nodes = this.props.node;\n      var svg = nodes.map(function (node) {\n        var _this3$clcCoordinate = _this3.clcCoordinate(node.lng, node.lat),\n            _this3$clcCoordinate2 = _slicedToArray(_this3$clcCoordinate, 2),\n            x = _this3$clcCoordinate2[0],\n            y = _this3$clcCoordinate2[1];\n\n        var name = node.name;\n\n        var setSE = _this3.setSE.bind(_this3);\n\n        var color = null;\n        var distance = '';\n        var info = ''; //显示不等式\n\n        if (_this3.state.start === node.name) {\n          color = \"#CCFFFF\";\n        }\n\n        if (_this3.state.end === node.name) {\n          color = \"#CC6699\";\n        }\n\n        if (_this3.state.S_NODE.has(node.name)) {\n          color = _this3.state.S_NODE.get(node.name);\n        }\n\n        if (_this3.state.S_NODE_DIS.has(node.name)) {\n          distance = _this3.state.S_NODE_DIS.get(node.name);\n        }\n\n        if (_this3.state.S_NODE_INFO.has(node.name)) {\n          info = _this3.state.S_NODE_INFO.get(node.name);\n        }\n\n        var data = {\n          name: name,\n          x: x,\n          y: y,\n          setSE: setSE,\n          color: color,\n          distance: distance,\n          info: info\n        }; //把data作为属性传递给Node\n\n        return React.createElement(Node, Object.assign({\n          key: \"node\" + node.name\n        }, data, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 160\n          },\n          __self: this\n        })); //Node类在此脚本末尾！\n        //react利用key来识别组件，它是一种身份标识标识,与props中的属性不同！！！\n      });\n      return svg;\n    }\n  }, {\n    key: \"renderLink\",\n    value: function renderLink() {\n      var _this4 = this;\n\n      var links = this.props.link;\n      var svg = links.map(function (link) {\n        if (!link.polyline.isVisible()) return;\n\n        var _this4$clcCoordinate = _this4.clcCoordinate(link.node1.lng, link.node1.lat),\n            _this4$clcCoordinate2 = _slicedToArray(_this4$clcCoordinate, 2),\n            x1 = _this4$clcCoordinate2[0],\n            y1 = _this4$clcCoordinate2[1];\n\n        var _this4$clcCoordinate3 = _this4.clcCoordinate(link.node2.lng, link.node2.lat),\n            _this4$clcCoordinate4 = _slicedToArray(_this4$clcCoordinate3, 2),\n            x2 = _this4$clcCoordinate4[0],\n            y2 = _this4$clcCoordinate4[1];\n\n        var s = {\n          name: link.node1.name,\n          x: x1,\n          y: y1\n        };\n        var e = {\n          name: link.node2.name,\n          x: x2,\n          y: y2\n        };\n        var color = link.polyline.getStrokeColor();\n        var dis = ''; //边的长度\n\n        var _iteratorNormalCompletion = true;\n        var _didIteratorError = false;\n        var _iteratorError = undefined;\n\n        try {\n          for (var _iterator = _this4.state.S_EDGE[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n            var edge = _step.value;\n\n            if (link.node1.name === edge[1][0] && link.node2.name === edge[1][1] || link.node1.name === edge[1][1] && link.node2.name === edge[1][0]) {\n              dis = edge[0]; //距离赋值\n\n              break;\n            }\n          }\n        } catch (err) {\n          _didIteratorError = true;\n          _iteratorError = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion && _iterator.return != null) {\n              _iterator.return();\n            }\n          } finally {\n            if (_didIteratorError) {\n              throw _iteratorError;\n            }\n          }\n        }\n\n        console.log(color, link);\n        return React.createElement(Link, {\n          key: \"link-\" + s.name + \"-\" + e.name,\n          from: s.name,\n          to: e.name,\n          x1: s.x,\n          y1: s.y,\n          x2: e.x,\n          y2: e.y,\n          color: color,\n          distance: dis,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 192\n          },\n          __self: this\n        });\n      });\n      return svg;\n    }\n  }, {\n    key: \"changeSpeed\",\n    value: function changeSpeed(event) {\n      var p = (event.clientX - this.getLeft(event.target)) / event.target.clientWidth;\n      console.log(p);\n      this.setState({\n        speed: p\n      });\n    }\n  }, {\n    key: \"play\",\n    value: function play(event) {\n      if (this.state.play === \"stop\") {\n        this.setState({\n          play: \"play\"\n        });\n        this.resetColor();\n        clearTimeout(window.timer);\n        this.go(); //go()包含了初始化以及animate\n      } else if (this.state.play === \"pause\") {\n        this.setState({\n          play: \"play\"\n        });\n        this.animate(); //继续执行\n      } else if (this.state.play === \"play\") {\n        this.setState({\n          play: \"pause\"\n        });\n        clearTimeout(window.timer); //暂停,取消计时器他就不再执行（但是所有状态都保存着<最重要是STEP_COUNT>，下次继续animate即可继续执行）\n      }\n    }\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      clearTimeout(window.timer);\n      actionStep.STEP_COUNT = 1; //this.setState({play: \"stop\", start: \"\", end: \"\", S_NODE:new Map(), S_EDGE: new Map()});\n\n      this.setState({\n        play: \"stop\",\n        start: \"\",\n        end: \"\",\n        S_NODE: new Map()\n      });\n      /* global layer */\n\n      layer.msg(\"结束\");\n    } //消息发布，用于组件间传递代码信息!\n\n  }, {\n    key: \"codeChangeHandler\",\n    value: function codeChangeHandler(code) {\n      eventProxy.trigger(window.showCode, code);\n    } //执行（包括数据传递给C++以及根据C++回传数据显示），会调用animate\n\n  }, {\n    key: \"go\",\n    value: function go() {\n      var _this5 = this;\n\n      if (!this.state.start || !this.state.end) {\n        return this.stop();\n      }\n\n      ;\n      var that = this; //this对象在程序中随时会改变，而var that=this之后，that没改变之前仍然是指向当时的this，这样就不会出现找不到原来的对象。\n\n      var edgeIn = [];\n      var pointIn = [];\n      var globalIn = [];\n      _name = []; //存储点的名字\n\n      this.props.node.forEach(function (node) {\n        //提取每个点的经度、维度、编号并存储在pointIn中(C++程序需要输入的点信息)\n        _name.push(node.name);\n\n        var lng = parseInt(node.lng);\n        var lat = parseInt(node.lat);\n        var index = '*' + (_name.length - 1) + '*';\n        pointIn.push([index, lng, lat]);\n      });\n      var start_index = '*' + _name.findIndex(function (v) {\n        return v === _this5.state.start;\n      }) + '*'; //找到起点、终点的编号\n\n      var end_index = '*' + _name.findIndex(function (v) {\n        return v === _this5.state.end;\n      }) + '*';\n      globalIn.push([pointIn.length]); //globalIn代表C++程序输入的参数：点数、？\n\n      pointIn = JSON.stringify(pointIn);\n      globalIn.push([-1000, 1000]);\n      globalIn.push([1000, -1000]);\n      globalIn = JSON.stringify(globalIn);\n      that.resetColor();\n      var S_NODE = new Map();\n      var S_EDGE = new Map();\n      var S_NODE_DIS = new Map();\n      var S_NODE_INFO = new Map();\n      this.setState({\n        S_NODE: S_NODE,\n        S_EDGE: S_EDGE,\n        S_NODE_DIS: S_NODE_DIS,\n        S_NODE_INFO: S_NODE_INFO\n      }); //向 setState() 中传入一个对象来对已有的 state 进行更新。\n\n      this.props.link.forEach(function (link) {\n        //整理edgeIn(编号、编号、距离),作为C++程序传入参数\n        if (!link.polyline.isVisible()) return;\n        var n1 = '*' + _name.findIndex(function (v) {\n          return v === link.node1.name;\n        }) + '*';\n        var n2 = '*' + _name.findIndex(function (v) {\n          return v === link.node2.name;\n        }) + '*';\n        edgeIn.push([n1, n2, parseFloat(link.dis, 10)]);\n      });\n      edgeIn = JSON.stringify(edgeIn); //////////////////////////////////////////////////////\n\n      window.layer.load(1, {\n        shade: [0.4, '#fff']\n      });\n      $.ajax({\n        type: \"POST\",\n        url: \"http://localhost:3001/data\",\n        data: {\n          edgeIn: edgeIn,\n          pointIn: pointIn,\n          globalIn: globalIn,\n          sName: start_index,\n          eName: end_index,\n          algo: window.algo\n        },\n        success: function success(json) {\n          //console.log(_name);\n          //console.log({start_index, end_index});\n          //console.log(json);\n          // //stepData包括code、steps  //stepData是C++计算传回的数据,根据stepData,前端做出相应动作\n          stepData = json; //steps的数据是各个动作的含义，比如：\tchangeNodeColor(2,RGB(255,0,0))\tAnimation\t8\n\n          layer.closeAll(); //先读一遍数据，记录每一帧对应的动作编号，便于快进、返回\n\n          for (var i = 0; i < stepData.steps.length - 1; i++) {\n            //暂未搞懂为什么多了一条动作？？？\n            //得到该动作对应帧的编号\n            var stepTemp = stepData.steps[i].split('\\t')[3];\n\n            if (stepData.steps[i].split('\\t')[1].split('(')[0] === \"Question\") {\n              //question动作的帧编号位置不同!\n              stepTemp = stepData.steps[i].split('\\t')[7];\n            } //将该动作编号纳入帧编号\n\n\n            if (stepTemp in actionStep) actionStep[stepTemp].push(i);else {\n              actionStep[stepTemp] = [];\n              actionStep[stepTemp].push(i);\n            }\n          } // 开始动画\n\n\n          that.animate(); //不能用this，因为ajax中的this已经不在代表外面的组件了!!!\n        },\n        error: function error() {\n          layer.closeAll();\n          layer.msg(\"出错, 提交失败\");\n        }\n      }); //////////////////////////////////////////////////////\n      // that.animate();\n    } //执行动画\n    //注意：当Question、showHelp、showCode时，之所以return是为了结束当前函数，不再执行当前函数末尾的animate\n    //因为在else if中会使用layer，内部接着使用了setTimeout和animate继续下去\n\n  }, {\n    key: \"animate\",\n    value: function animate() {\n      var _this6 = this;\n\n      // if(this.state.play!==\"play\")return;\n      //setTimeout(code,millisec), code是要执行的代码，lillisec是遇到setTimer后要等待多少毫秒才执行code!\n      //返回数值id，整型，可用于 取消 setTimeout 设置的函数clearTimeout(id)。也就是这个setTimeout的唯一标示符\n      window.timer = setTimeout(function () {\n        var step = _this6.getStep(STEP_COUNT); //获取一帧的全部数据\n\n\n        layer.closeAll();\n        STEP_COUNT++;\n\n        if (step === null) {\n          _this6.stop();\n\n          return;\n        }\n\n        var links = _this6.props.link; //将要更新的元素\n\n        var S_NODE = _this6.state.S_NODE;\n        var S_EDGE = _this6.state.S_EDGE;\n        var S_NODE_DIS = _this6.state.S_NODE_DIS;\n        var S_NODE_INFO = _this6.state.S_NODE_INFO;\n\n        for (var i = 0; i < step.types.length; i++) {\n          if (step.types[i] === \"changeEdgeColor\") {\n            (function () {\n              var params = step.infos[i][1].split(\"(\")[1].split(\",\");\n              params.pop();\n              var color = step.infos[i][1].split(\"RGB\")[1];\n              color = _this6.chooseColor(color); //改变边的颜色\n\n              var name1 = _name[parseInt(params[0])];\n\n              var name2 = _name[parseInt(params[1])];\n\n              links.forEach(function (link) {\n                if (link.polyline.isVisible()) {\n                  if (link.node1.name === name1 && link.node2.name === name2 || link.node1.name === name2 && link.node2.name === name1) {\n                    link.polyline.setStrokeColor(color);\n                  }\n                }\n              }); //this.props.updateState(null, links);\n            })();\n          } else if (step.types[i] === \"changeNodeColor\") {\n            var idx = step.infos[i][1].split(\"(\")[1].split(\",\")[0];\n            idx = parseInt(idx);\n            var color = step.infos[i][1].split(\"RGB\")[1];\n            color = _this6.chooseColor(color);\n            var name = _name[idx]; //找到编号对应的点名\n\n            S_NODE.set(name, color); //S_NODE是键值对，改变name对应点的状态\n            //this.setState({S_NODE});\n          } else if (step.types[i] === \"changeEdgeLength\") {\n            //\"20\tchangeEdgeLength(0,1,1173)\tAnimation\t2\";\n            var params = step.infos[i][1].split('(')[1].split(')')[0].split(','); //获取点编号、边距离\n\n            var name1 = _name[parseInt(params[0])]; //起点编号\n\n\n            var name2 = _name[parseInt(params[1])];\n\n            var dis = parseFloat(params[2]);\n            S_EDGE.set(dis, [name1, name2]);\n          } else if (step.types[i] === \"changeNodeDist\") {\n            var params = step.infos[i][1].split('(')[1].split(')')[0].split(',');\n\n            var _idx = parseInt(params[0]); //点的编号\n\n\n            var distance = parseFloat(params[1]);\n            var _name2 = _name[_idx]; //点名\n\n            S_NODE_DIS.set(_name2, distance);\n          } else if (step.types[i] === \"showCode\") {\n            var that = _this6;\n            var param = step.infos[i][1].split('(')[1].split(')')[0];\n            var codeName = \"code\" + param + \".txt\";\n            $.ajax({\n              type: \"POST\",\n              url: \"http://localhost:3001/code\",\n              data: {\n                codeName: codeName\n              },\n              success: function success(code) {\n                that.codeChangeHandler(code); //不能用this，因为ajax中的this已经不在代表外面的组件了!!!???\n              },\n              error: function error() {\n                console.log('获取代码失败！');\n              }\n            });\n          } else if (step.types[i] === \"showHelp\") {\n            var msg = step.infos[i][1].split(\"(\")[1].split(\")\")[0];\n            layer.msg(msg, {\n              time: _this6.state.speed * 3000 + 70\n            });\n          } else if (step.types[i] === \"Question\" && window.question) {\n            var que = step.infos[i][2];\n            var ans = step.infos[i][3];\n\n            if (ans[0] === \"*\") {\n              ans = ans.replace(/\\*/g, \"\");\n              ans = _name[ans];\n            }\n\n            return _this6.ask(que, ans);\n          } else if (step.types[i] === \"showInequality\") {\n            var params = step.infos[i][1].split('(')[1].split(')')[0].split(',');\n\n            var _idx2 = parseInt(params[0]); //点的编号\n\n\n            var info = params[1];\n            var _name3 = _name[_idx2]; //点名\n\n            S_NODE_INFO.set(_name3, info);\n          } else if (step.types[i] === \"InequalityDisapper\") {\n            var params = step.infos[i][1].split('(')[1].split(')')[0].split(',');\n\n            var _idx3 = parseInt(params[0]); //点的编号\n\n\n            var _info = ''; //将信息（不等式）置空\n\n            var _name4 = _name[_idx3]; //点名\n\n            S_NODE_INFO.set(_name4, _info);\n          }\n        } //对一帧中的各元素统一进行刷新\n\n\n        _this6.props.updateState(null, links); //this.setState({S_NODE});\n        //this.setState({S_EDGE});\n        //this.setState({S_NODE_DIS});\n        //this.setState({S_NODE_INFO});\n\n\n        _this6.setState({\n          S_NODE: S_NODE,\n          S_EDGE: S_EDGE,\n          S_NODE_DIS: S_NODE_DIS,\n          S_NODE_INFO: S_NODE_INFO\n        });\n\n        _this6.animate(); //重复执行\n\n      }, this.state.speed * 3000 + 70);\n    } //学长原来是获取每一个动作信息－>此处改为获取每一个步骤(帧)的信息\n\n  }, {\n    key: \"getStep\",\n    value: function getStep(nStep) {\n      console.log(\"get step:\" + nStep); //读取一帧的数据\n\n      var types = new Array(); //创建数组，用于保存动作信息\n\n      var infos = new Array();\n\n      if (nStep in actionStep) {\n        for (var i = 0; i < actionStep[nStep].length; i++) {\n          var info = stepData.steps[actionStep[nStep][i]].split('\\t'); //第ACTION_COUNT条动作信息(作为数组保存在info)                  \n\n          var type = info[1].split('(')[0]; //info[1]代表动作的解释：changeNodeColor(4,RGB(91,155,213))；  则type对应changeNodeColor\n\n          types.push(type);\n          infos.push(info);\n        }\n\n        return {\n          types: types,\n          infos: infos\n        }; //返回对象，对象的属性是键值对\n      }\n\n      return null;\n    }\n  }, {\n    key: \"chooseColor\",\n    value: function chooseColor(color) {\n      switch (color) {\n        case \"(10,10,10))\":\n          return this.INITIAL_LINK_COLOR;\n        //初始化边（接近黑色）\n\n        case \"(91,155,213))\":\n          return this.INITIAL_NODE_COLOR;\n        //初始化点（接近蓝色)\n\n        case \"(255,0,0))\":\n          return this.SELECTED_LINK_COLOR;\n        //选中点、边（红色）\n\n        default:\n          return \"#000000\";\n      }\n    }\n  }, {\n    key: \"checkLink\",\n    value: function checkLink(link, name1, name2) {\n      var node1 = link.node1;\n      var node2 = link.node2;\n\n      if (node1.name === name1 && node2.name === name2 || node1.name === name2 && node2.name === name1) {\n        return true;\n      }\n\n      return false;\n    } //重置link颜色\n\n  }, {\n    key: \"resetColor\",\n    value: function resetColor() {\n      var _this7 = this;\n\n      var links = this.props.link;\n      links.forEach(function (link) {\n        if (link.polyline.isVisible()) link.polyline.setStrokeColor(_this7.DEFAULT_LINK_COLOR);\n      });\n      this.props.updateState(null, links);\n    }\n    /*获取元素的横坐标*/\n\n  }, {\n    key: \"getLeft\",\n    value: function getLeft(e) {\n      var offset = e.offsetLeft;\n\n      if (e.offsetParent != null) {\n        offset += this.getLeft(e.offsetParent);\n      }\n\n      return offset;\n    } //设置起点终点\n\n  }, {\n    key: \"setSE\",\n    value: function setSE(event) {\n      event.preventDefault();\n      event.stopPropagation();\n      var that = this;\n      var name = event.target.attributes.id.value.split(\"_\").pop();\n      /*\n      let menu = new nw.Menu();\n      menu.append(new nw.MenuItem({\n      \tlabel: '设为起点',\n      \tclick: function(){\n                    that.setState({start: name});\n      \t}\n      }));\n      menu.append(new nw.MenuItem({\n      \tlabel: '设为终点',\n      \tclick: function(){\n                    that.setState({end: name});\n      \t}\n      }));\n      menu.popup(event.clientX, event.clientY);*/\n\n      var menu = new MyMenu(\"MyMenu_Node_SVG\");\n      menu.append([{\n        label: '设为起点',\n        click: function click() {\n          that.setState({\n            start: name\n          });\n        }\n      }, {\n        label: '设为终点',\n        click: function click() {\n          that.setState({\n            end: name\n          });\n        }\n      }]);\n      menu.popup(event.clientX, event.clientY);\n      return false;\n    } //提问\n\n  }, {\n    key: \"ask\",\n    value: function ask(que, msg) {\n      clearTimeout(window.timer);\n      var that = this;\n      window.layer.prompt({\n        title: que\n      }, function (text, index) {\n        layer.closeAll();\n\n        if (text != msg) {\n          window.layer.msg('正确答案：' + msg, {\n            time: 1000\n          }); ///////////////////////////////////////////////////////\n\n          $.ajax({\n            type: \"POST\",\n            url: \"/collect\",\n            data: {\n              que: que,\n              ans: text,\n              msg: msg\n            },\n            success: function success(json) {},\n            error: function error() {}\n          }); ///////////////////////////////////////////////////////\n\n          setTimeout(function () {\n            that.animate();\n          }, 1100);\n        } else {\n          that.animate();\n        }\n      });\n    }\n  }, {\n    key: \"showCode\",\n    value: function showCode(msg) {\n      var content = \"\";\n\n      if (msg === 1) {\n        content = \"\\n        <p style=\\\"white-space:pre-wrap !important; padding: 30px;\\\">    void DFS(Graph& G, int v)\\n        {\\n            <span style=\\\"color: red\\\">visited[v] = 1;\\t</span>\\n            for (int w = FirstAdjVex(G, v); w != -1; w = NextAdjVex(G, v, w))\\n            {\\n                if (!visited[w])\\n                {\\n                    DFS(G, w);\\n                }\\n            }\\n        }</p>\\n            \";\n      } else if (msg === 2) {\n        content = \"\\n        <p style=\\\"white-space:pre-wrap !important; padding: 30px;\\\">    void DFS(Graph& G, int v)\\n        {\\n            visited[v] = 1;\\t\\n            <span style=\\\"color: red\\\">for (int w = FirstAdjVex(G, v); w != -1; w = NextAdjVex(G, v, w))\\n            {\\n                if (!visited[w])\\n                {\\n                    DFS(G, w);\\n                }\\n            }</span>\\n        }</p>\\n            \";\n      }\n\n      var that = this; //页面层\n\n      window.layer.open({\n        type: 1,\n        area: ['800px', '400px'],\n        //宽高\n        content: content,\n        closeBtn: false,\n        title: '提示',\n        btn: '关闭',\n        yes: function yes() {\n          layer.closeAll();\n          that.animate();\n        }\n      });\n    } //****************************************************dd by cdz\n    //执行动作：根据STEP_COUNT执行！！！\n    //注意：当Question、showHelp、showCode时，之所以return是为了结束当前函数，不再执行当前函数末尾的animate\n    //因为在else if中会使用layer，内部接着使用了setTimeout和animate继续下去\n    //倒退:为了减少不必要的理解错误，只能倒退到点和边初始化完成以后\n\n  }, {\n    key: \"animate_back\",\n    value: function animate_back() {\n      var _this8 = this;\n\n      //不管处于什么状态，都使其暂停\n      this.setState({\n        play: \"pause\"\n      });\n      clearTimeout(window.timer);\n      layer.closeAll();\n      STEP_COUNT--;\n      var back_step = this.getStep(STEP_COUNT);\n\n      if (back_step === null) {\n        this.stop();\n        return;\n      }\n\n      var links = this.props.link; //将要更新的元素\n\n      var S_NODE = this.state.S_NODE;\n      var S_EDGE = this.state.S_EDGE;\n      var S_NODE_DIS = this.state.S_NODE_DIS;\n      var S_NODE_INFO = this.state.S_NODE_INFO;\n\n      for (var i = 0; i < back_step.types.length; i++) {\n        if (back_step.types[i] === \"changeEdgeColor\") {\n          (function () {\n            var params = back_step.infos[i][1].split(\"(\")[1].split(\",\");\n            params.pop();\n            var color = back_step.infos[i][1].split(\"RGB\")[1];\n            color = _this8.chooseColor(color); //改变边的颜色\n\n            var name1 = _name[parseInt(params[0])];\n\n            var name2 = _name[parseInt(params[1])];\n\n            links.forEach(function (link) {\n              if (link.polyline.isVisible()) {\n                if (link.node1.name === name1 && link.node2.name === name2 || link.node1.name === name2 && link.node2.name === name1) {\n                  link.polyline.setStrokeColor(color);\n                }\n              }\n            }); //this.props.updateState(null, links);\n          })();\n        } else if (back_step.types[i] === \"changeNodeColor\") {\n          var idx = back_step.infos[i][1].split(\"(\")[1].split(\",\")[0];\n          idx = parseInt(idx);\n          var color = back_step.infos[i][1].split(\"RGB\")[1];\n          color = this.chooseColor(color);\n          var name = _name[idx]; //找到编号对应的点名\n\n          S_NODE.set(name, color); //S_NODE是键值对，改变name对应点的状态\n          //this.setState({S_NODE});\n        } else if (back_step.types[i] === \"changeEdgeLength\") {\n          //\"20\tchangeEdgeLength(0,1,1173)\tAnimation\t2\";\n          var params = back_step.infos[i][1].split('(')[1].split(')')[0].split(','); //获取点编号、边距离\n\n          var name1 = _name[parseInt(params[0])]; //起点编号\n\n\n          var name2 = _name[parseInt(params[1])];\n\n          var dis = parseFloat(params[2]);\n          S_EDGE.set(dis, [name1, name2]);\n        } else if (back_step.types[i] === \"changeNodeDist\") {\n          var params = back_step.infos[i][1].split('(')[1].split(')')[0].split(',');\n\n          var _idx4 = parseInt(params[0]); //点的编号\n\n\n          var distance = parseFloat(params[1]);\n          var _name5 = _name[_idx4]; //点名\n\n          S_NODE_DIS.set(_name5, distance);\n        } else if (back_step.types[i] === \"showCode\") {\n          var that = this;\n          var param = back_step.infos[i][1].split('(')[1].split(')')[0];\n          var codeName = \"code\" + param + \".txt\";\n          $.ajax({\n            type: \"POST\",\n            url: \"http://localhost:3001/code\",\n            data: {\n              codeName: codeName\n            },\n            success: function success(code) {\n              that.codeChangeHandler(code); //不能用this，因为ajax中的this已经不在代表外面的组件了!!!???\n            },\n            error: function error() {\n              console.log('获取代码失败！');\n            }\n          });\n        } else if (back_step.types[i] === \"showHelp\") {\n          var msg = back_step.infos[i][1].split(\"(\")[1].split(\")\")[0];\n          layer.msg(msg, {\n            time: this.state.speed * 300000 + 70\n          }); //无限停留\n        } else if (back_step.types[i] === \"Question\" && window.question) {\n          var que = back_step.infos[i][2];\n          var ans = back_step.infos[i][3];\n\n          if (ans[0] === \"*\") {\n            ans = ans.replace(/\\*/g, \"\");\n            ans = _name[ans];\n          }\n\n          return this.ask(que, ans);\n        } else if (back_step.types[i] === \"showInequality\") {\n          var params = back_step.infos[i][1].split('(')[1].split(')')[0].split(',');\n\n          var _idx5 = parseInt(params[0]); //点的编号\n\n\n          var info = params[1];\n          var _name6 = _name[_idx5]; //点名\n\n          S_NODE_INFO.set(_name6, info);\n        } else if (back_step.types[i] === \"InequalityDisapper\") {\n          var params = back_step.infos[i][1].split('(')[1].split(')')[0].split(',');\n\n          var _idx6 = parseInt(params[0]); //点的编号\n\n\n          var _info2 = ''; //将信息（不等式）置空\n\n          var _name7 = _name[_idx6]; //点名\n\n          S_NODE_INFO.set(_name7, _info2);\n        }\n      } //对一帧中的各元素统一进行刷新\n\n\n      this.props.updateState(null, links); //this.setState({S_NODE});\n      //this.setState({S_EDGE});\n      //this.setState({S_NODE_DIS});\n      //this.setState({S_NODE_INFO});\n\n      this.setState({\n        S_NODE: S_NODE,\n        S_EDGE: S_EDGE,\n        S_NODE_DIS: S_NODE_DIS,\n        S_NODE_INFO: S_NODE_INFO\n      });\n    } //前进\n\n  }, {\n    key: \"animate_forward\",\n    value: function animate_forward() {\n      //不管处于什么状态，都使其暂停\n      this.setState({\n        play: \"pause\"\n      });\n      clearTimeout(window.timer);\n      layer.closeAll();\n      actionStep.STEP_COUNT++;\n      var forward_step = this.getStep(actionStep);\n\n      if (forward_step === null) {\n        this.stop();\n        return;\n      }\n\n      if (forward_step.type === \"changeEdgeColor\") {\n        var params = forward_step.info[1].split(\"(\")[1].split(\",\");\n        params.pop();\n        var color = forward_step.info[1].split(\"RGB\")[1];\n        color = this.chooseColor(color);\n        this.changeEdgeColor(parseInt(params[0]), parseInt(params[1]), color);\n      } else if (forward_step.type === \"changeNodeColor\") {\n        var idx = forward_step.info[1].split(\"(\")[1].split(\",\")[0];\n        idx = parseInt(idx);\n        var _color = forward_step.info[1].split(\"RGB\")[1];\n        _color = this.chooseColor(_color);\n        this.changeNodeColor(idx, _color);\n      } else if (forward_step.type === \"Question\" && window.question) {\n        var que = forward_step.info[2];\n        var ans = forward_step.info[3];\n\n        if (ans[0] === \"*\") {\n          ans = ans.replace(/\\*/g, \"\");\n          ans = _name[ans];\n        } //修改ask函数\n\n\n        var that = this;\n        window.layer.prompt({\n          title: que\n        }, function (text, index) {\n          layer.closeAll();\n\n          if (text != ans) {\n            window.layer.msg('正确答案：' + ans, {\n              time: 3000000\n            }); //驻留在该帧\n          }\n        });\n      } else if (forward_step.type === \"showHelp\") {\n        var msg = forward_step.info[1].split(\"(\")[1].split(\")\")[0];\n        layer.msg(msg, {\n          time: 3000000\n        }); //驻留在该帧\n      } else if (forward_step.type === \"showCode\") {\n        var _msg = forward_step.info[1].split(\"(\")[1].split(\")\")[0];\n        _msg = parseInt(_msg, 10);\n        var content = \"\";\n\n        if (_msg === 1) {\n          content = \"\\n        <p style=\\\"white-space:pre-wrap !important; padding: 30px;\\\">    void DFS(Graph& G, int v)\\n        {\\n            <span style=\\\"color: red\\\">visited[v] = 1;\\t</span>\\n            for (int w = FirstAdjVex(G, v); w != -1; w = NextAdjVex(G, v, w))\\n            {\\n                if (!visited[w])\\n                {\\n                    DFS(G, w);\\n                }\\n            }\\n        }</p>\\n            \";\n        } else if (_msg === 2) {\n          content = \"\\n        <p style=\\\"white-space:pre-wrap !important; padding: 30px;\\\">    void DFS(Graph& G, int v)\\n        {\\n            visited[v] = 1;\\t\\n            <span style=\\\"color: red\\\">for (int w = FirstAdjVex(G, v); w != -1; w = NextAdjVex(G, v, w))\\n            {\\n                if (!visited[w])\\n                {\\n                    DFS(G, w);\\n                }\\n            }</span>\\n        }</p>\\n            \";\n        }\n\n        var _that = this; //页面层\n\n\n        window.layer.open({\n          type: 1,\n          area: ['800px', '400px'],\n          //宽高\n          content: content,\n          closeBtn: false,\n          title: '提示',\n          btn: '关闭',\n          yes: function yes() {\n            layer.closeAll();\n          }\n        });\n      }\n    }\n  }]);\n\n  return GraphSVG;\n}(React.Component);\n\nvar Node =\n/*#__PURE__*/\nfunction (_React$Component2) {\n  _inherits(Node, _React$Component2);\n\n  function Node(props) {\n    var _this9;\n\n    _classCallCheck(this, Node);\n\n    _this9 = _possibleConstructorReturn(this, _getPrototypeOf(Node).call(this, props));\n    _this9.SELECT_COLOR = \"#300\";\n    _this9.DEFAULT_COLOR = \"#3C9\";\n    return _this9;\n  } //<g>元素通常用来对相关图形元素进行分组\n  //onContextMenu：对应右击鼠标的响应事件\n\n\n  _createClass(Node, [{\n    key: \"render\",\n    value: function render() {\n      var _React$createElement, _React$createElement2;\n\n      return React.createElement(\"g\", {\n        id: \"node_\" + this.props.name,\n        onContextMenu: this.props.setSE,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 871\n        },\n        __self: this\n      }, React.createElement(\"circle\", {\n        id: \"node_circle_\" + this.props.name,\n        cx: this.props.x,\n        cy: this.props.y,\n        r: this.props.r || 20,\n        fill: this.props.color || this.DEFAULT_COLOR,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 872\n        },\n        __self: this\n      }), React.createElement(\"text\", {\n        id: \"node_text_\" + this.props.name,\n        x: this.props.x,\n        y: this.props.y,\n        fill: \"black\",\n        textAnchor: \"middle\",\n        dominantBaseline: \"middle\",\n        style: {\n          fontSize: \"13px\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 873\n        },\n        __self: this\n      }, this.props.hide || this.props.name), React.createElement(\"text\", (_React$createElement = {\n        id: \"node_value\" + this.props.name,\n        x: this.props.x,\n        y: this.props.y + 10,\n        fill: \"black\",\n        textAnchor: \"middle\",\n        dominantBaseline: \"middle\",\n        fontSize: \"13px\"\n      }, _defineProperty(_React$createElement, \"fill\", \"blue\"), _defineProperty(_React$createElement, \"__source\", {\n        fileName: _jsxFileName,\n        lineNumber: 874\n      }), _defineProperty(_React$createElement, \"__self\", this), _React$createElement), this.props.distance), React.createElement(\"text\", (_React$createElement2 = {\n        id: \"node_value\" + this.props.name,\n        x: this.props.x + 40,\n        y: this.props.y - 5,\n        fill: \"black\",\n        textAnchor: \"middle\",\n        dominantBaseline: \"middle\",\n        fontSize: \"13px\"\n      }, _defineProperty(_React$createElement2, \"fill\", \"black\"), _defineProperty(_React$createElement2, \"__source\", {\n        fileName: _jsxFileName,\n        lineNumber: 875\n      }), _defineProperty(_React$createElement2, \"__self\", this), _React$createElement2), this.props.info));\n    }\n  }, {\n    key: \"hover\",\n    value: function hover(event) {\n      console.log(event.target.attributes.fill);\n      console.log(event.target.attributes);\n      var attributes = event.target.attributes;\n    }\n  }]);\n\n  return Node;\n}(React.Component);\n\nvar Link =\n/*#__PURE__*/\nfunction (_React$Component3) {\n  _inherits(Link, _React$Component3);\n\n  function Link(props) {\n    var _this10;\n\n    _classCallCheck(this, Link);\n\n    _this10 = _possibleConstructorReturn(this, _getPrototypeOf(Link).call(this, props));\n    _this10.SELECT_COLOR = \"#900\";\n    _this10.DEFAULT_COLOR = _this10.props.color;\n    return _this10;\n  }\n\n  _createClass(Link, [{\n    key: \"render\",\n    value: function render() {\n      this.DEFAULT_COLOR = this.props.color;\n      return React.createElement(\"g\", {\n        id: \"link_\" + this.props.from + \"_\" + this.props.to,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 896\n        },\n        __self: this\n      }, React.createElement(\"line\", {\n        x1: this.props.x1,\n        y1: this.props.y1,\n        x2: this.props.x2,\n        y2: this.props.y2,\n        stroke: this.props.color,\n        strokeWidth: \"5\",\n        style: {\n          cursor: \"pointer\"\n        },\n        onMouseEnter: this.hover.bind(this),\n        onMouseLeave: this.hover.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 897\n        },\n        __self: this\n      }), React.createElement(\"text\", {\n        x: (this.props.x1 + this.props.x2) / 2,\n        y: (this.props.y1 + this.props.y2) / 2,\n        style: {\n          fontSize: \"15px\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 898\n        },\n        __self: this\n      }, this.props.distance));\n    }\n  }, {\n    key: \"hover\",\n    value: function hover(event) {\n      var attributes = event.target.attributes;\n      attributes.stroke.value === this.SELECT_COLOR ? attributes.stroke.value = this.DEFAULT_COLOR : attributes.stroke.value = this.SELECT_COLOR;\n    }\n  }]);\n\n  return Link;\n}(React.Component);\n\nexport default GraphSVG;","map":{"version":3,"sources":["/home/cdz/Code/FrontEnd/nw-react/src/app/component/GraphSVG.js"],"names":["Graph","MyMenu","eventProxy","assertFunctionParent","require","React","$","window","jQuery","stepData","_name","actionStep","STEP_COUNT","question","GraphSVG","props","state","DEFAULT_LINK_COLOR","INITIAL_LINK_COLOR","INITIAL_NODE_COLOR","SELECTED_LINK_COLOR","SELECTED_NODE_COLOR","path","speed","play","start","end","S_NODE","Map","S_EDGE","S_NODE_DIS","S_NODE_INFO","clcMaxMin","nodes","renderNode","links","renderLink","controlstate","width","height","backgroundColor","e","preventDefault","checkChange","bind","changeSpeed","animate_back","animate_forward","stop","target","checked","console","log","setState","max_lng","Infinity","min_lng","max_lat","min_lat","mid_lng","mid_lat","node","forEach","lat","lng","length","w","refs","graph","clientWidth","h","clientHeight","margin","svg","map","clcCoordinate","x","y","name","setSE","color","distance","info","has","get","data","link","polyline","isVisible","node1","x1","y1","node2","x2","y2","s","getStrokeColor","dis","edge","event","p","clientX","getLeft","resetColor","clearTimeout","timer","go","animate","layer","msg","code","trigger","showCode","that","edgeIn","pointIn","globalIn","push","parseInt","index","start_index","findIndex","v","end_index","JSON","stringify","n1","n2","parseFloat","load","shade","ajax","type","url","sName","eName","algo","success","json","closeAll","i","steps","stepTemp","split","error","setTimeout","step","getStep","types","params","infos","pop","chooseColor","name1","name2","setStrokeColor","idx","set","param","codeName","codeChangeHandler","time","que","ans","replace","ask","updateState","nStep","Array","offset","offsetLeft","offsetParent","stopPropagation","attributes","id","value","menu","append","label","click","popup","clientY","prompt","title","text","content","open","area","closeBtn","btn","yes","back_step","forward_step","changeEdgeColor","changeNodeColor","Component","Node","SELECT_COLOR","DEFAULT_COLOR","r","fontSize","hide","fill","Link","from","to","cursor","hover","stroke"],"mappings":"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","sourcesContent":["//import d3 from './d3.v4.min.js';\n//window.d3 = d3;\n//import $ from 'jquery';  //引入jquery\nimport Graph from \"./Graph.js\";\nimport MyMenu from \"../MyMenu.js\";\nimport eventProxy from \"../eventProxy.js\"\nimport { assertFunctionParent } from \"babel-types\";\nrequire('../../assets/play.png');\nrequire('../../assets/pause.png');\nlet React = require('react');\n\n\n//readme: 学长的代码中node的改变是通过state.S_NODE实现，edge(颜色)的改变是通过this.props.link实现!!!!!\n//经补充修改后，边上路径长度的改变通过state.S_EDGE实现\n   \n//import stepData from \"./testData.js\";\nlet $=window.jQuery;\nlet stepData = null;\nlet _name = [];     //存储点名\n//let STEP_COUNT = 0;　　　//学长以STEP_COUNT记录每一个动作的编号（是动作不是帧！！）->改为每一帧的编号\nlet actionStep={};        //用于存储步骤动作信息,eg:   {3:[3,4,5,6]}表示第三帧包含动作3、4、５＼６\nlet STEP_COUNT=1;         //全局记录当前演示的帧数\nwindow.question = true;\n\nclass GraphSVG extends React.Component{\n    //其属性来自Panel...this.pros的传递,包括updtaState、node、link\n    constructor(props){\n        super(props);\n        this.state = {};\n\n        //注意：关于点、边的颜色\n        //ＤＦＳ后台传递的颜色：初始化边表示（１０，１０，１０），初始点表示(91,155,2１3),选中点边表示（255,0,0）\n        //DJ后台传递颜色:初始化边（１０，１０，１０），初始化点（９１，１５５，２１３），\n\n        this.DEFAULT_LINK_COLOR = \"#3a6bdb\";  //默认是(浅蓝色)\n        this.INITIAL_LINK_COLOR = \"#0a0a0a\";   //初始化后边的颜色\n        this.INITIAL_NODE_COLOR = \"#5B9BD5\";  //初始化后点的颜色\n        this.SELECTED_LINK_COLOR = \"#ff0000\";   //选中的边，红色\n        this.SELECTED_NODE_COLOR = \"#ff0000\";   //选中的点     \n       \n        this.path = null;\n\n        this.state.speed = 0.5;\n        this.state.play = \"stop\";\n        this.state.start = \"\";\n        this.state.end = \"\";\n        this.state.S_NODE = new Map(); //更新点的颜色;　　　　　　　　　Map是一组键值对的结构，具有极快的查找速度(误以为是Map.js导出的Map类)\n        this.state.S_EDGE = new Map();  //更新边的距离\n        this.state.question= true;\n        this.state.S_NODE_DIS=new Map(); //更新点到起点的距离\n        this.state.S_NODE_INFO=new Map(); //更新点旁边的其他信息，如显示不等式\n    }\n    render(){\n        this.clcMaxMin();\n        let nodes = this.renderNode();\n        let links = this.renderLink();\n\n        let controlstate = this.state.play===\"play\"?\"pauseState\":\"playState\";\n\n        return (\n            <div id=\"graphWrap\">\n                <div id=\"main\">\n                    <div style={{width:\"100%\", height:\"100%\", backgroundColor:\"#FFF\"}}>\n                        <svg ref=\"graph\" width=\"100%\" height=\"100%\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" onContextMenu={(e)=>{e.preventDefault();}}>\n                            {links}\n                            {nodes}\n                        </svg>\n                    </div>\n                </div>\n                <div id=\"tool\">\n                    <div id=\"question\"> 提问 <input id=\"question_checkbox\" type=\"checkbox\" checked={this.state.question} onChange={this.checkChange.bind(this)}/> </div>\n                    <div id=\"speed\" title=\"速度\" onClick={this.changeSpeed.bind(this)}>\n                        <div id=\"speedValue\" style={{width: this.state.speed*100+\"%\"}}></div>\n                    </div>\n                    <div id=\"prev\" title=\"上一步\" onClick={this.animate_back.bind(this)}></div>\n                    <div id=\"start\" title=\"开始/暂停\" className={controlstate} onClick={this.play.bind(this)}></div>\n                    <div id=\"next\" title=\"下一步\" onClick={this.animate_forward.bind(this)}></div>\n                    <div id=\"end\" title=\"结束\" onClick={this.stop.bind(this)}></div>\n                </div>\n            </div>\n        );\n    }\n\n    //是否提问状态改变\n    checkChange(e){\n        window.question = e.target.checked;\n        console.log(window.question);\n        this.setState({question: !this.state.question});\n    }\n\n    clcMaxMin(){\n        let max_lng = -Infinity, min_lng = Infinity;\n        let max_lat = -Infinity, min_lat = Infinity;\n\n        this.mid_lng = 0;\n        this.mid_lat = 0;\n\n        this.props.node.forEach(node=>{\n            if(node.lat>max_lat)max_lat = node.lat;\n            if(node.lat<min_lat)min_lat = node.lat;\n\n            if(node.lng>max_lng)max_lng = node.lng;\n            if(node.lng<min_lng)min_lng = node.lng;\n            \n            this.mid_lng += node.lng;\n            this.mid_lat += node.lat;\n        });\n\n        this.max_lng = max_lng;\n        this.min_lng = min_lng;\n\n        this.max_lat = max_lat;\n        this.min_lat = min_lat;\n\n        this.mid_lng /= this.props.node.length;\n        this.mid_lat /= this.props.node.length;\n    }\n\n    clcCoordinate(lng, lat){\n        let w = this.refs.graph.clientWidth;\n        let h = this.refs.graph.clientHeight;\n\n        let margin = 50;\n\n        // w = (w-margin - margin)/(this.max_lat-this.min_lat + 0.001)*(lat-this.min_lat) + margin;\n        // h = h - ( (h-margin - margin)/(this.max_lng-this.min_lng + 0.001)*(lng-this.min_lng) + margin ) ;\n\n        w = (w-margin - margin)/(this.max_lng-this.min_lng + 0.001)*(lng-this.min_lng) + margin;\n        h = h - ( (h-margin - margin)/(this.max_lat-this.min_lat + 0.001)*(lat-this.min_lat) + margin ) ;\n\n        return [w, h];\n    }\n\n    renderNode(){\n        let nodes = this.props.node;\n        let svg = nodes.map(node=>{\n            let [x, y] = this.clcCoordinate(node.lng, node.lat);\n            let name = node.name;\n            let setSE = this.setSE.bind(this);\n            let color = null;\n            let distance='';\n            let info='';  //显示不等式\n\n            if(this.state.start===node.name){\n                color = \"#CCFFFF\";\n            }\n             if(this.state.end===node.name){\n                color = \"#CC6699\";\n            }\n            if(this.state.S_NODE.has(node.name)){\n                color = this.state.S_NODE.get(node.name);\n            }\n            if(this.state.S_NODE_DIS.has(node.name)){\n                distance=this.state.S_NODE_DIS.get(node.name);\n            }\n            if(this.state.S_NODE_INFO.has(node.name)){\n                info=this.state.S_NODE_INFO.get(node.name);\n            }\n            let data = {name, x, y, setSE, color,distance,info};   //把data作为属性传递给Node\n            return ( <Node key={\"node\"+node.name} {...data}/> );   //Node类在此脚本末尾！\n            //react利用key来识别组件，它是一种身份标识标识,与props中的属性不同！！！\n        });\n        return svg;\n    }\n\n    renderLink(){\n        let links = this.props.link;\n        let svg = links.map(link=>{\n            if(!link.polyline.isVisible())return;\n            let [x1, y1] = this.clcCoordinate(link.node1.lng, link.node1.lat);\n            let [x2, y2] = this.clcCoordinate(link.node2.lng, link.node2.lat);\n            let s = {\n                name: link.node1.name,\n                x: x1,\n                y: y1,\n            };\n            let e = {\n                name: link.node2.name,\n                x: x2,\n                y: y2,\n            };\n            let color = link.polyline.getStrokeColor();\n            let dis='';  //边的长度\n            for(var edge of this.state.S_EDGE){\n                if((link.node1.name===edge[1][0]&&link.node2.name===edge[1][1])||(link.node1.name===edge[1][1]&&link.node2.name===edge[1][0])){\n                    dis=edge[0]; //距离赋值\n                    break;\n                }\n            }\n           \n            console.log(color, link);\n            return ( <Link key={\"link-\"+s.name+\"-\"+e.name} from={s.name} to={e.name} x1={s.x} y1={s.y} x2={e.x} y2={e.y} color={color} distance={dis}/> );\n        });\n        return svg;\n    }\n\n    changeSpeed(event){\n        let p = (event.clientX - this.getLeft(event.target)) / event.target.clientWidth;\n        console.log(p);\n        this.setState({speed: p});\n    }\n\n    play(event){\n        if(this.state.play===\"stop\"){\n            this.setState({play: \"play\"});\n            this.resetColor();\n            clearTimeout(window.timer);\n            this.go();           //go()包含了初始化以及animate\n            \n        }else if(this.state.play===\"pause\"){\n            this.setState({play: \"play\"});\n            this.animate();     //继续执行\n\n        }else if(this.state.play===\"play\"){\n\n            this.setState({play: \"pause\"});\n            clearTimeout(window.timer);  //暂停,取消计时器他就不再执行（但是所有状态都保存着<最重要是STEP_COUNT>，下次继续animate即可继续执行）\n\n        }\n    }\n\n    stop(){\n        clearTimeout(window.timer);\n        actionStep.STEP_COUNT = 1;\n        //this.setState({play: \"stop\", start: \"\", end: \"\", S_NODE:new Map(), S_EDGE: new Map()});\n        this.setState({play: \"stop\", start: \"\", end: \"\", S_NODE:new Map()});\n         /* global layer */\n        layer.msg(\"结束\");\n    }\n\n    //消息发布，用于组件间传递代码信息!\n    codeChangeHandler(code){\n        eventProxy.trigger(window.showCode,code);\n    }\n\n    //执行（包括数据传递给C++以及根据C++回传数据显示），会调用animate\n    go(){\n        if(!this.state.start || !this.state.end){\n            return this.stop();\n        };\n\n        var that = this;   //this对象在程序中随时会改变，而var that=this之后，that没改变之前仍然是指向当时的this，这样就不会出现找不到原来的对象。\n\n        var edgeIn = [];\n        var pointIn = [];\n        var globalIn = [];\n\n\n        _name = [];       //存储点的名字\n\n        this.props.node.forEach(node=>{  //提取每个点的经度、维度、编号并存储在pointIn中(C++程序需要输入的点信息)\n            _name.push(node.name);\n            let lng = parseInt(node.lng);\n            let lat = parseInt(node.lat);\n            let index = '*'+(_name.length-1)+'*'\n            pointIn.push([index, lng, lat]);\n        });\n\n        var start_index = '*'+(_name.findIndex(v=>v===this.state.start))+'*';  //找到起点、终点的编号\n        var end_index = '*'+(_name.findIndex(v=>v===this.state.end))+'*';\n\n\n        globalIn.push([pointIn.length]);     //globalIn代表C++程序输入的参数：点数、？\n        pointIn = JSON.stringify(pointIn);\n        globalIn.push([-1000, 1000]);\n        globalIn.push([1000, -1000]);\n        globalIn = JSON.stringify(globalIn);\n\n        \n        that.resetColor();\n        let S_NODE = new Map();\n        let S_EDGE = new Map();\n        let S_NODE_DIS=new Map();\n        let S_NODE_INFO=new Map();\n        this.setState({S_NODE, S_EDGE,S_NODE_DIS,S_NODE_INFO});  //向 setState() 中传入一个对象来对已有的 state 进行更新。\n\n\n        this.props.link.forEach(link=>{        //整理edgeIn(编号、编号、距离),作为C++程序传入参数\n            if(!link.polyline.isVisible())return;\n            let n1 = '*'+_name.findIndex(v=>v===link.node1.name)+'*';\n            let n2 = '*'+_name.findIndex(v=>v===link.node2.name)+'*';\n            edgeIn.push([n1, n2, parseFloat(link.dis, 10)]);\n        });\n        edgeIn = JSON.stringify(edgeIn);\n//////////////////////////////////////////////////////\n        window.layer.load(1, {shade: [0.4,'#fff']});\n        $.ajax({\n            type:\"POST\",\n            url:\"http://localhost:3001/data\",\n            data:{edgeIn:edgeIn,pointIn:pointIn,globalIn:globalIn,sName:start_index,eName:end_index,algo:window.algo},\n            success: function(json){\n                //console.log(_name);\n                //console.log({start_index, end_index});\n                //console.log(json);\n                // //stepData包括code、steps  //stepData是C++计算传回的数据,根据stepData,前端做出相应动作\n                stepData = json;  //steps的数据是各个动作的含义，比如：\tchangeNodeColor(2,RGB(255,0,0))\tAnimation\t8\n                layer.closeAll();\n                \n                //先读一遍数据，记录每一帧对应的动作编号，便于快进、返回\n                for(var i=0;i<stepData.steps.length-1;i++){  //暂未搞懂为什么多了一条动作？？？\n                    //得到该动作对应帧的编号\n                    var stepTemp=stepData.steps[i].split('\\t')[3];    \n                    if(stepData.steps[i].split('\\t')[1].split('(')[0]===\"Question\"){ //question动作的帧编号位置不同!\n                        stepTemp=stepData.steps[i].split('\\t')[7];\n                    }\n\n                    //将该动作编号纳入帧编号\n                    if(stepTemp in actionStep)\n                        actionStep[stepTemp].push(i);\n                    else{\n                        actionStep[stepTemp]=[];\n                        actionStep[stepTemp].push(i);\n                    }\n                }\n\n\n                // 开始动画\n                that.animate();   //不能用this，因为ajax中的this已经不在代表外面的组件了!!!\n            },\n            error: function(){\n                layer.closeAll();\n                layer.msg(\"出错, 提交失败\");\n            }\n        });\n//////////////////////////////////////////////////////\n\n        // that.animate();\n\n    }\n\n    //执行动画\n    //注意：当Question、showHelp、showCode时，之所以return是为了结束当前函数，不再执行当前函数末尾的animate\n    //因为在else if中会使用layer，内部接着使用了setTimeout和animate继续下去\n    animate(){\n        // if(this.state.play!==\"play\")return;\n        //setTimeout(code,millisec), code是要执行的代码，lillisec是遇到setTimer后要等待多少毫秒才执行code!\n        //返回数值id，整型，可用于 取消 setTimeout 设置的函数clearTimeout(id)。也就是这个setTimeout的唯一标示符\n        window.timer = setTimeout(()=>{\n\n            let step = this.getStep(STEP_COUNT);  //获取一帧的全部数据\n            layer.closeAll();\n            STEP_COUNT++;\n            if(step===null){\n                this.stop();\n                return;\n            }\n            let links = this.props.link;  //将要更新的元素\n            let S_NODE = this.state.S_NODE;\n            let S_EDGE=this.state.S_EDGE;\n            let S_NODE_DIS=this.state.S_NODE_DIS;\n            let S_NODE_INFO=this.state.S_NODE_INFO;\n\n            for(var i=0;i<step.types.length;i++){\n                if(step.types[i]===\"changeEdgeColor\"){\n                    let params = step.infos[i][1].split(\"(\")[1].split(\",\");\n                    params.pop();\n                    let color = step.infos[i][1].split(\"RGB\")[1];\n                    color = this.chooseColor(color);\n                \n                    //改变边的颜色\n                    let name1 = _name[parseInt(params[0])];\n                    let name2 = _name[parseInt(params[1])];\n                    links.forEach(link=>{\n                        if(link.polyline.isVisible()){\n                            if((link.node1.name===name1&&link.node2.name===name2)||(link.node1.name===name2&&link.node2.name===name1)){\n                                link.polyline.setStrokeColor(color);\n                            }\n                        }\n                    });\n                    //this.props.updateState(null, links);\n                }\n                else if(step.types[i]===\"changeNodeColor\"){\n                    let idx = step.infos[i][1].split(\"(\")[1].split(\",\")[0];\n                    idx = parseInt(idx);\n                    let color = step.infos[i][1].split(\"RGB\")[1];\n                    color = this.chooseColor(color);\n                    let name = _name[idx];  //找到编号对应的点名\n                    S_NODE.set(name,color);  //S_NODE是键值对，改变name对应点的状态\n                    //this.setState({S_NODE});\n                }\n                else if(step.types[i]===\"changeEdgeLength\"){\n                    //\"20\tchangeEdgeLength(0,1,1173)\tAnimation\t2\";\n                    var params=step.infos[i][1].split('(')[1].split(')')[0].split(','); //获取点编号、边距离\n                    let name1 = _name[parseInt(params[0])];  //起点编号\n                    let name2 = _name[parseInt(params[1])];　\n                   let dis=parseFloat(params[2]);\n                   S_EDGE.set(dis,[name1,name2]);\n                \n                }\n                else if(step.types[i]===\"changeNodeDist\"){\n                    var params=step.infos[i][1].split('(')[1].split(')')[0].split(',');\n                    let idx=parseInt(params[0]);  //点的编号\n                    let distance=parseFloat(params[1]);\n                    let name=_name[idx];   //点名\n                    S_NODE_DIS.set(name,distance);\n                }\n                else if(step.types[i]===\"showCode\"){\n                    var that=this;\n                    var param=step.infos[i][1].split('(')[1].split(')')[0];\n                    var codeName=\"code\"+param+\".txt\";\n                    $.ajax({\n                        type:\"POST\",\n                        url:\"http://localhost:3001/code\",\n                        data:{codeName:codeName},\n                        success: function(code){\n                        that.codeChangeHandler(code);   //不能用this，因为ajax中的this已经不在代表外面的组件了!!!???\n                        },\n                        error: function(){\n                            console.log('获取代码失败！');\n                        }\n                    });\n                }\n                else if(step.types[i]===\"showHelp\"){\n                    let msg = step.infos[i][1].split(\"(\")[1].split(\")\")[0];\n                    layer.msg(msg, {time: this.state.speed *3000 +70});   \n                }\n                else if(step.types[i]===\"Question\" && window.question){\n                    let que = step.infos[i][2];\n                    let ans = step.infos[i][3];\n                    if(ans[0]===\"*\"){\n                        ans = ans.replace(/\\*/g, \"\");\n                        ans = _name[ans];\n                    }\n                    return this.ask(que, ans);   \n                }\n                else if(step.types[i]===\"showInequality\"){\n                    var params=step.infos[i][1].split('(')[1].split(')')[0].split(',');\n                    let idx=parseInt(params[0]);  //点的编号\n                    let info=params[1];\n                    let name=_name[idx];   //点名\n                    S_NODE_INFO.set(name,info);\n                }\n                else if(step.types[i]===\"InequalityDisapper\"){\n                    var params=step.infos[i][1].split('(')[1].split(')')[0].split(',');\n                    let idx=parseInt(params[0]);  //点的编号\n                    let info='';  //将信息（不等式）置空\n                    let name=_name[idx];   //点名\n                    S_NODE_INFO.set(name,info);\n                }\n                \n            }\n\n            //对一帧中的各元素统一进行刷新\n            this.props.updateState(null, links);\n            //this.setState({S_NODE});\n            //this.setState({S_EDGE});\n            //this.setState({S_NODE_DIS});\n            //this.setState({S_NODE_INFO});\n            this.setState({S_NODE,S_EDGE,S_NODE_DIS,S_NODE_INFO});\n            this.animate();  //重复执行\n\n        }, this.state.speed *3000 +70);\n    \n    }\n\n   \n    //学长原来是获取每一个动作信息－>此处改为获取每一个步骤(帧)的信息\n    getStep(nStep){\n\n        console.log(\"get step:\"+nStep); //读取一帧的数据\n\n        var types=new Array(); //创建数组，用于保存动作信息\n        var infos=new Array(); \n\n        if(nStep in actionStep){\n            for(var i=0;i<actionStep[nStep].length;i++){\n                let info = stepData.steps[actionStep[nStep][i]].split('\\t');  //第ACTION_COUNT条动作信息(作为数组保存在info)                  \n                let type = info[1].split('(')[0];   //info[1]代表动作的解释：changeNodeColor(4,RGB(91,155,213))；  则type对应changeNodeColor\n                types.push(type);\n                infos.push(info);\n            }\n            return {types, infos};  //返回对象，对象的属性是键值对\n        }\n        return null;\n  \n    }\n\n    chooseColor(color){\n        switch(color){\n            case \"(10,10,10))\": return this.INITIAL_LINK_COLOR;   //初始化边（接近黑色）\n            case \"(91,155,213))\": return this.INITIAL_NODE_COLOR; //初始化点（接近蓝色)\n            case \"(255,0,0))\": return this.SELECTED_LINK_COLOR;    //选中点、边（红色）\n            default: return \"#000000\";\n        }\n    }\n\n    checkLink(link, name1, name2){\n        let node1 = link.node1;\n        let node2 = link.node2;\n        if( (node1.name===name1 && node2.name===name2) || (node1.name===name2 && node2.name===name1) ){\n            return true;\n        }\n        return false;\n    }\n\n    //重置link颜色\n    resetColor(){\n        let links = this.props.link;\n        links.forEach(link=>{\n            if(link.polyline.isVisible())\n                link.polyline.setStrokeColor(this.DEFAULT_LINK_COLOR); \n        });\n        this.props.updateState(null, links);\n    }\n\n    /*获取元素的横坐标*/\n    getLeft(e){\n        var offset=e.offsetLeft;\n        if(e.offsetParent!=null){\n        offset+=this.getLeft(e.offsetParent);\n        } \n        return offset;\n    } \n\n    //设置起点终点\n    setSE(event){\n        event.preventDefault();\n        event.stopPropagation();\n        let that = this;\n        let name = event.target.attributes.id.value.split(\"_\").pop();\n\t\t/*\n\t\tlet menu = new nw.Menu();\n\t\tmenu.append(new nw.MenuItem({\n\t\t\tlabel: '设为起点',\n\t\t\tclick: function(){\n                that.setState({start: name});\n\t\t\t}\n\t\t}));\n\t\tmenu.append(new nw.MenuItem({\n\t\t\tlabel: '设为终点',\n\t\t\tclick: function(){\n                that.setState({end: name});\n\t\t\t}\n\t\t}));\n\t\tmenu.popup(event.clientX, event.clientY);*/\n\t\tlet menu = new MyMenu(\"MyMenu_Node_SVG\");\n\t\tmenu.append([{\n\t\t\tlabel: '设为起点',\n\t\t\tclick: function(){\n                that.setState({start: name});\n\t\t\t}\n        },{\n\t\t\tlabel: '设为终点',\n\t\t\tclick: function(){\n                that.setState({end: name});\n\t\t\t}\n        }]);\n        menu.popup(event.clientX, event.clientY);\n\t\t\n\t\treturn false;\n    }\n\n    //提问\n    ask(que, msg){\n        clearTimeout(window.timer);\n        let that = this;\n        window.layer.prompt({title: que}, function(text, index){\n            layer.closeAll();\n            if(text!=msg){\n                window.layer.msg('正确答案：'+msg, {time: 1000});\n                ///////////////////////////////////////////////////////\n                $.ajax({\n                    type:\"POST\",\n                    url:\"/collect\",\n                    data:{que:que,ans:text,msg:msg},\n                    success: function(json){\n                    },\n                    error: function(){\n                    }\n                });\n        ///////////////////////////////////////////////////////\n                setTimeout(()=>{\n                    that.animate();\n                }, 1100);\n            }else{\n                that.animate();\n            }\n        } );\n    }\n\n    showCode(msg){\n        let content = \"\";\n        if(msg === 1){\n            content = \n            `\n        <p style=\"white-space:pre-wrap !important; padding: 30px;\">    void DFS(Graph& G, int v)\n        {\n            <span style=\"color: red\">visited[v] = 1;\t</span>\n            for (int w = FirstAdjVex(G, v); w != -1; w = NextAdjVex(G, v, w))\n            {\n                if (!visited[w])\n                {\n                    DFS(G, w);\n                }\n            }\n        }</p>\n            `\n        }else if(msg === 2){\n            content = \n            `\n        <p style=\"white-space:pre-wrap !important; padding: 30px;\">    void DFS(Graph& G, int v)\n        {\n            visited[v] = 1;\t\n            <span style=\"color: red\">for (int w = FirstAdjVex(G, v); w != -1; w = NextAdjVex(G, v, w))\n            {\n                if (!visited[w])\n                {\n                    DFS(G, w);\n                }\n            }</span>\n        }</p>\n            `\n        }\n        let that = this;\n        //页面层\n        window.layer.open({\n            type: 1,\n            area: ['800px', '400px'], //宽高\n            content: content,\n            closeBtn: false,\n            title: '提示',\n            btn: '关闭',\n            yes: function(){\n                layer.closeAll();\n                that.animate();\n            }            \n        });\n    }\n\n\n   //****************************************************dd by cdz\n    //执行动作：根据STEP_COUNT执行！！！\n    //注意：当Question、showHelp、showCode时，之所以return是为了结束当前函数，不再执行当前函数末尾的animate\n    //因为在else if中会使用layer，内部接着使用了setTimeout和animate继续下去\n\n\n   //倒退:为了减少不必要的理解错误，只能倒退到点和边初始化完成以后\n   animate_back(){\n    //不管处于什么状态，都使其暂停\n    this.setState({play: \"pause\"});\n    clearTimeout(window.timer);\n    layer.closeAll();\n   \n\n    STEP_COUNT--;\n    let back_step = this.getStep(STEP_COUNT);\n    if(back_step===null){\n        this.stop();\n        return;\n    }\n\n    let links = this.props.link;  //将要更新的元素\n    let S_NODE = this.state.S_NODE;\n    let S_EDGE=this.state.S_EDGE;\n    let S_NODE_DIS=this.state.S_NODE_DIS;\n    let S_NODE_INFO=this.state.S_NODE_INFO;\n\n    for(var i=0;i<back_step.types.length;i++){\n        if(back_step.types[i]===\"changeEdgeColor\"){\n            let params = back_step.infos[i][1].split(\"(\")[1].split(\",\");\n            params.pop();\n            let color =back_step.infos[i][1].split(\"RGB\")[1];\n            color = this.chooseColor(color);\n            \n            //改变边的颜色\n            let name1 = _name[parseInt(params[0])];\n            let name2 = _name[parseInt(params[1])];\n            links.forEach(link=>{\n                if(link.polyline.isVisible()){\n                    if((link.node1.name===name1&&link.node2.name===name2)||(link.node1.name===name2&&link.node2.name===name1)){\n                        link.polyline.setStrokeColor(color);\n                    }\n                }\n             });\n                //this.props.updateState(null, links);\n            }\n        else if(back_step.types[i]===\"changeNodeColor\"){\n            let idx = back_step.infos[i][1].split(\"(\")[1].split(\",\")[0];\n            idx = parseInt(idx);\n            let color = back_step.infos[i][1].split(\"RGB\")[1];\n            color = this.chooseColor(color);\n            let name = _name[idx];  //找到编号对应的点名\n            S_NODE.set(name,color);  //S_NODE是键值对，改变name对应点的状态\n            //this.setState({S_NODE});\n            }\n        else if(back_step.types[i]===\"changeEdgeLength\"){\n            //\"20\tchangeEdgeLength(0,1,1173)\tAnimation\t2\";\n            var params=back_step.infos[i][1].split('(')[1].split(')')[0].split(','); //获取点编号、边距离\n            let name1 = _name[parseInt(params[0])];  //起点编号\n            let name2 = _name[parseInt(params[1])];　\n            let dis=parseFloat(params[2]);\n             S_EDGE.set(dis,[name1,name2]); \n        }\n         else if(back_step.types[i]===\"changeNodeDist\"){\n            var params=back_step.infos[i][1].split('(')[1].split(')')[0].split(',');\n            let idx=parseInt(params[0]);  //点的编号\n            let distance=parseFloat(params[1]);\n            let name=_name[idx];   //点名\n            S_NODE_DIS.set(name,distance);\n        }\n        else if(back_step.types[i]===\"showCode\"){\n            var that=this;\n            var param=back_step.infos[i][1].split('(')[1].split(')')[0];\n            var codeName=\"code\"+param+\".txt\";\n            $.ajax({\n                    type:\"POST\",\n                    url:\"http://localhost:3001/code\",\n                    data:{codeName:codeName},\n                    success: function(code){\n                    that.codeChangeHandler(code);   //不能用this，因为ajax中的this已经不在代表外面的组件了!!!???\n                    },\n                    error: function(){\n                        console.log('获取代码失败！');\n                    }\n            });\n        }\n        else if(back_step.types[i]===\"showHelp\"){\n            let msg =back_step.infos[i][1].split(\"(\")[1].split(\")\")[0];\n            layer.msg(msg, {time: this.state.speed *300000 +70});  //无限停留\n        }\n        else if(back_step.types[i]===\"Question\" && window.question){\n            let que = back_step.infos[i][2];\n             let ans = back_step.infos[i][3];\n             if(ans[0]===\"*\"){\n                 ans = ans.replace(/\\*/g, \"\");\n                 ans = _name[ans];\n             }\n            return this.ask(que, ans);   \n        }\n         else if(back_step.types[i]===\"showInequality\"){\n            var params=back_step.infos[i][1].split('(')[1].split(')')[0].split(',');\n            let idx=parseInt(params[0]);  //点的编号\n            let info=params[1];\n            let name=_name[idx];   //点名\n            S_NODE_INFO.set(name,info);\n         }\n         else if(back_step.types[i]===\"InequalityDisapper\"){\n            var params=back_step.infos[i][1].split('(')[1].split(')')[0].split(',');\n            let idx=parseInt(params[0]);  //点的编号\n            let info='';  //将信息（不等式）置空\n            let name=_name[idx];   //点名\n            S_NODE_INFO.set(name,info);\n        }\n            \n    }\n    //对一帧中的各元素统一进行刷新\n    this.props.updateState(null, links);\n    //this.setState({S_NODE});\n    //this.setState({S_EDGE});\n    //this.setState({S_NODE_DIS});\n    //this.setState({S_NODE_INFO});\n    this.setState({S_NODE,S_EDGE,S_NODE_DIS,S_NODE_INFO});\n    }\n\n    \n\n   //前进\n   animate_forward(){\n        //不管处于什么状态，都使其暂停\n    this.setState({play: \"pause\"});\n    clearTimeout(window.timer);\n    layer.closeAll();\n\n    actionStep.STEP_COUNT++;\n    let forward_step = this.getStep(actionStep);\n    if(forward_step===null){\n        this.stop();\n        return;\n    }\n\n    if(forward_step.type===\"changeEdgeColor\"){\n        let params = forward_step.info[1].split(\"(\")[1].split(\",\");\n        params.pop();\n        let color = forward_step.info[1].split(\"RGB\")[1];\n        color = this.chooseColor(color);\n        this.changeEdgeColor(parseInt(params[0]),parseInt(params[1]),color);\n    }else if(forward_step.type===\"changeNodeColor\"){\n        let idx = forward_step.info[1].split(\"(\")[1].split(\",\")[0];\n        idx = parseInt(idx);\n        let color =forward_step.info[1].split(\"RGB\")[1];\n        color = this.chooseColor(color);\n        this.changeNodeColor(idx,color);\n    }else if(forward_step.type===\"Question\" && window.question){\n        let que = forward_step.info[2];\n        let ans = forward_step.info[3];\n        if(ans[0]===\"*\"){\n            ans = ans.replace(/\\*/g, \"\");\n            ans = _name[ans];\n        }\n        //修改ask函数\n        let that = this;\n        window.layer.prompt({title: que}, function(text, index){\n            layer.closeAll();\n            if(text!=ans){\n                window.layer.msg('正确答案：'+ans, {time: 3000000});  //驻留在该帧\n            }\n        });  \n    }else if(forward_step.type===\"showHelp\"){\n        let msg =forward_step.info[1].split(\"(\")[1].split(\")\")[0];\n        layer.msg(msg, {time: 3000000});    //驻留在该帧\n        \n    }else if(forward_step.type===\"showCode\"){\n        let msg = forward_step.info[1].split(\"(\")[1].split(\")\")[0];\n        msg = parseInt(msg, 10);\n        let content = \"\";\n        if(msg === 1){\n            content = \n            `\n        <p style=\"white-space:pre-wrap !important; padding: 30px;\">    void DFS(Graph& G, int v)\n        {\n            <span style=\"color: red\">visited[v] = 1;\t</span>\n            for (int w = FirstAdjVex(G, v); w != -1; w = NextAdjVex(G, v, w))\n            {\n                if (!visited[w])\n                {\n                    DFS(G, w);\n                }\n            }\n        }</p>\n            `\n        }else if(msg === 2){\n            content = \n            `\n        <p style=\"white-space:pre-wrap !important; padding: 30px;\">    void DFS(Graph& G, int v)\n        {\n            visited[v] = 1;\t\n            <span style=\"color: red\">for (int w = FirstAdjVex(G, v); w != -1; w = NextAdjVex(G, v, w))\n            {\n                if (!visited[w])\n                {\n                    DFS(G, w);\n                }\n            }</span>\n        }</p>\n            `\n        }\n        let that = this;\n        //页面层\n        window.layer.open({\n            type: 1,\n            area: ['800px', '400px'], //宽高\n            content: content,\n            closeBtn: false,\n            title: '提示',\n            btn: '关闭',\n            yes: function(){\n                layer.closeAll();\n            }            \n        });\n    }\n\n   }\n\n\n}\n\n\n\n\nclass Node extends React.Component{\n    constructor(props){\n        super(props);\n        this.SELECT_COLOR = \"#300\";\n        this.DEFAULT_COLOR = \"#3C9\";\n    }\n\n    //<g>元素通常用来对相关图形元素进行分组\n    //onContextMenu：对应右击鼠标的响应事件\n    render(){\n        return (\n            <g id={\"node_\"+this.props.name} onContextMenu={this.props.setSE}>\n                <circle id={\"node_circle_\"+this.props.name} cx={this.props.x} cy={this.props.y} r={this.props.r || 20} fill={this.props.color ||　this.DEFAULT_COLOR}></circle>\n                <text id={\"node_text_\"+this.props.name} x={this.props.x} y={this.props.y} fill=\"black\" textAnchor=\"middle\" dominantBaseline=\"middle\" style={{fontSize: \"13px\"}}>{this.props.hide || this.props.name}</text>\n                <text id={\"node_value\"+this.props.name} x={this.props.x} y={this.props.y+10} fill=\"black\" textAnchor=\"middle\" dominantBaseline=\"middle\" fontSize='13px' fill='blue'>{this.props.distance}</text>\n                <text id={\"node_value\"+this.props.name} x={this.props.x+40} y={this.props.y-5} fill=\"black\" textAnchor=\"middle\" dominantBaseline=\"middle\" fontSize='13px' fill='black'>{this.props.info}</text>\n            </g>\n        );\n    }\n    hover(event){\n        console.log(event.target.attributes.fill);\n        console.log(event.target.attributes);\n        let attributes = event.target.attributes;\n    }\n}\n\nclass Link extends React.Component{\n\n    constructor(props){\n        super(props);\n        this.SELECT_COLOR = \"#900\";\n        this.DEFAULT_COLOR = this.props.color;\n    }\n    render(){\n        this.DEFAULT_COLOR = this.props.color;\n         return (\n            <g id={\"link_\"+this.props.from+\"_\"+this.props.to}>\n                 <line x1={this.props.x1} y1={this.props.y1} x2={this.props.x2} y2={this.props.y2} stroke={this.props.color} strokeWidth=\"5\" style={{cursor: \"pointer\"}} onMouseEnter={this.hover.bind(this)} onMouseLeave={this.hover.bind(this)}/>\n                 <text x={(this.props.x1+this.props.x2)/2} y={(this.props.y1+this.props.y2)/2}  style={{fontSize:\"15px\"}}>{this.props.distance}</text>\n             </g>\n        );\n    }\n    hover(event){\n        let attributes = event.target.attributes;\n        attributes.stroke.value===this.SELECT_COLOR ? attributes.stroke.value=this.DEFAULT_COLOR : attributes.stroke.value=this.SELECT_COLOR;\n    }\n}\n\nexport default GraphSVG;"]},"metadata":{},"sourceType":"module"}